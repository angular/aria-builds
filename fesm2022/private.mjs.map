{"version":3,"file":"private.mjs","sources":["../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/combobox/combobox.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/menu/menu.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/signal-like/signal-like.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/expansion/expansion.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/behaviors/label/label.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/tabs/tabs.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/toolbar/toolbar.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/toolbar/toolbar-widget.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/toolbar/toolbar-widget-group.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/accordion/accordion.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/tree/tree.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/tree/combobox-tree.ts","../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/deferred-content/deferred-content.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {KeyboardEventManager, PointerEventManager} from '../behaviors/event-manager';\nimport {computed, signal} from '@angular/core';\nimport {SignalLike, WritableSignalLike} from '../behaviors/signal-like/signal-like';\nimport {ListItem} from '../behaviors/list/list';\n\n/** Represents the required inputs for a combobox. */\nexport interface ComboboxInputs<T extends ListItem<V>, V> {\n  /** The controls for the popup associated with the combobox. */\n  popupControls: SignalLike<\n    ComboboxListboxControls<T, V> | ComboboxTreeControls<T, V> | ComboboxDialogPattern | undefined\n  >;\n\n  /** The HTML input element that serves as the combobox input. */\n  inputEl: SignalLike<HTMLInputElement | undefined>;\n\n  /** The HTML element that serves as the combobox container. */\n  containerEl: SignalLike<HTMLElement | undefined>;\n\n  /** The filtering mode for the combobox. */\n  filterMode: SignalLike<'manual' | 'auto-select' | 'highlight'>;\n\n  /** The current value of the combobox. */\n  inputValue?: WritableSignalLike<string>;\n\n  /** The value of the first matching item in the popup. */\n  firstMatch: SignalLike<V | undefined>;\n\n  /** Whether the combobox is disabled. */\n  disabled: SignalLike<boolean>;\n\n  /** Whether the combobox is read-only. */\n  readonly: SignalLike<boolean>;\n\n  /** Whether the combobox is in a right-to-left context. */\n  textDirection: SignalLike<'rtl' | 'ltr'>;\n\n  /** Whether the combobox is always expanded. */\n  alwaysExpanded: SignalLike<boolean>;\n}\n\n/** An interface that allows combobox popups to expose the necessary controls for the combobox. */\nexport interface ComboboxListboxControls<T extends ListItem<V>, V> {\n  /** A unique identifier for the popup. */\n  id: () => string;\n\n  /** The ARIA role for the popup. */\n  role: SignalLike<'listbox' | 'tree' | 'grid'>;\n\n  // TODO(wagnermaciel): Add validation that ensures only readonly comboboxes can have multi-select popups.\n\n  /** Whether multiple items in the popup can be selected at once. */\n  multi: SignalLike<boolean>;\n\n  /** The ID of the active item in the popup. */\n  activeId: SignalLike<string | undefined>;\n\n  /** The list of items in the popup. */\n  items: SignalLike<T[]>;\n\n  /** Navigates to the given item in the popup. */\n  focus: (item: T, opts?: {focusElement?: boolean}) => void;\n\n  /** Navigates to the next item in the popup. */\n  next: () => void;\n\n  /** Navigates to the previous item in the popup. */\n  prev: () => void;\n\n  /** Navigates to the first item in the popup. */\n  first: () => void;\n\n  /** Navigates to the last item in the popup. */\n  last: () => void;\n\n  /** Selects the current item in the popup. */\n  select: (item?: T) => void;\n\n  /** Toggles the selection state of the given item in the popup. */\n  toggle: (item?: T) => void;\n\n  /** Clears the selection state of the popup. */\n  clearSelection: () => void;\n\n  /** Removes focus from any item in the popup. */\n  unfocus: () => void;\n\n  /** Returns the item corresponding to the given event. */\n  getItem: (e: PointerEvent) => T | undefined;\n\n  /** Returns the currently active (focused) item in the popup. */\n  getActiveItem: () => T | undefined;\n\n  /** Returns the currently selected items in the popup. */\n  getSelectedItems: () => T[];\n\n  /** Sets the value of the combobox based on the selected item. */\n  setValue: (value: V | undefined) => void; // For re-setting the value if the popup was destroyed.\n}\n\nexport interface ComboboxTreeControls<T extends ListItem<V>, V> extends ComboboxListboxControls<\n  T,\n  V\n> {\n  /** Whether the currently active item in the popup is collapsible. */\n  isItemCollapsible: () => boolean;\n\n  /** Expands the currently active item in the popup. */\n  expandItem: () => void;\n\n  /** Collapses the currently active item in the popup. */\n  collapseItem: () => void;\n\n  /** Checks if the currently active item in the popup is expandable. */\n  isItemExpandable: (item?: T) => boolean;\n\n  /** Expands all nodes in the tree. */\n  expandAll: () => void;\n\n  /** Collapses all nodes in the tree. */\n  collapseAll: () => void;\n\n  /** Toggles the expansion state of the currently active item in the popup. */\n  toggleExpansion: (item?: T) => void;\n\n  /** Whether the current active item is selectable. */\n  isItemSelectable: (item?: T) => boolean;\n}\n\n/** Controls the state of a combobox. */\nexport class ComboboxPattern<T extends ListItem<V>, V> {\n  /** Whether the combobox is expanded. */\n  expanded = signal(false);\n\n  /** Whether the combobox is disabled. */\n  disabled = () => this.inputs.disabled();\n\n  /** The ID of the active item in the combobox. */\n  activeDescendant = computed(() => {\n    const popupControls = this.inputs.popupControls();\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return null;\n    }\n\n    return popupControls?.activeId() ?? null;\n  });\n\n  /** The currently highlighted item in the combobox. */\n  highlightedItem = signal<T | undefined>(undefined);\n\n  /** Whether the most recent input event was a deletion. */\n  isDeleting = false;\n\n  /** Whether the combobox is focused. */\n  isFocused = signal(false);\n\n  /** Whether the combobox has ever been focused. */\n  hasBeenFocused = signal(false);\n\n  /** The key used to navigate to the previous item in the list. */\n  expandKey = computed(() => (this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight'));\n\n  /** The key used to navigate to the next item in the list. */\n  collapseKey = computed(() =>\n    this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft',\n  );\n\n  /** The ID of the popup associated with the combobox. */\n  popupId = computed(() => this.inputs.popupControls()?.id() || null);\n\n  /** The autocomplete behavior of the combobox. */\n  autocomplete = computed(() => (this.inputs.filterMode() === 'highlight' ? 'both' : 'list'));\n\n  /** The ARIA role of the popup associated with the combobox. */\n  hasPopup = computed(() => this.inputs.popupControls()?.role() || null);\n\n  /** Whether the combobox is read-only. */\n  readonly = computed(() => this.inputs.readonly() || this.inputs.disabled() || null);\n\n  /** Returns the listbox controls for the combobox. */\n  listControls = () => {\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return null;\n    }\n\n    return popupControls;\n  };\n\n  /** Returns the tree controls for the combobox. */\n  treeControls = () => {\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls?.role() === 'tree') {\n      return popupControls as ComboboxTreeControls<T, V>;\n    }\n\n    return null;\n  };\n\n  /** The keydown event manager for the combobox. */\n  keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n    const popupControls = this.inputs.popupControls();\n\n    if (!popupControls) {\n      return manager;\n    }\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      if (!this.expanded()) {\n        manager.on('ArrowUp', () => this.open()).on('ArrowDown', () => this.open());\n\n        if (this.readonly()) {\n          manager.on('Enter', () => this.open()).on(' ', () => this.open());\n        }\n      }\n\n      return manager;\n    }\n\n    if (!this.inputs.alwaysExpanded()) {\n      manager.on('Escape', () => this.close({reset: !this.readonly()}));\n    }\n\n    if (!this.expanded()) {\n      manager\n        .on('ArrowDown', () => this.open({first: true}))\n        .on('ArrowUp', () => this.open({last: true}));\n\n      if (this.readonly()) {\n        manager\n          .on('Enter', () => this.open({selected: true}))\n          .on(' ', () => this.open({selected: true}));\n      }\n\n      return manager;\n    }\n\n    manager\n      .on('ArrowDown', () => this.next())\n      .on('ArrowUp', () => this.prev())\n      .on('Home', () => this.first())\n      .on('End', () => this.last());\n\n    if (this.readonly()) {\n      manager.on(' ', () => this.select({commit: true, close: !popupControls.multi()}));\n    }\n\n    if (popupControls.role() === 'listbox') {\n      manager.on('Enter', () => {\n        this.select({commit: true, close: !popupControls.multi()});\n      });\n    }\n\n    const treeControls = this.treeControls();\n\n    if (treeControls?.isItemSelectable()) {\n      manager.on('Enter', () => this.select({commit: true, close: true}));\n    }\n\n    if (treeControls?.isItemExpandable()) {\n      manager\n        .on(this.expandKey(), () => this.expandItem())\n        .on(this.collapseKey(), () => this.collapseItem());\n\n      if (!treeControls.isItemSelectable()) {\n        manager.on('Enter', () => this.expandItem());\n      }\n    }\n\n    if (treeControls?.isItemCollapsible()) {\n      manager.on(this.collapseKey(), () => this.collapseItem());\n    }\n\n    return manager;\n  });\n\n  /** The click event manager for the combobox. */\n  click = computed(() =>\n    new PointerEventManager().on(e => {\n      if (e.target === this.inputs.inputEl()) {\n        if (this.readonly()) {\n          this.expanded() ? this.close() : this.open({selected: true});\n        }\n      }\n\n      const controls = this.inputs.popupControls();\n\n      if (controls instanceof ComboboxDialogPattern) {\n        return;\n      }\n\n      const item = controls?.getItem(e);\n\n      if (item) {\n        if (controls?.role() === 'tree') {\n          const treeControls = controls as ComboboxTreeControls<T, V>;\n\n          if (treeControls.isItemExpandable(item) && !treeControls.isItemSelectable(item)) {\n            treeControls.toggleExpansion(item);\n            this.inputs.inputEl()?.focus();\n            return;\n          }\n        }\n\n        this.select({item, commit: true, close: !controls?.multi()});\n        this.inputs.inputEl()?.focus(); // Return focus to the input after selecting.\n      }\n    }),\n  );\n\n  constructor(readonly inputs: ComboboxInputs<T, V>) {}\n\n  /** Handles keydown events for the combobox. */\n  onKeydown(event: KeyboardEvent) {\n    if (!this.inputs.disabled()) {\n      this.keydown().handle(event);\n    }\n  }\n\n  /** Handles click events for the combobox. */\n  onClick(event: MouseEvent) {\n    if (!this.inputs.disabled()) {\n      this.click().handle(event as PointerEvent);\n    }\n  }\n\n  /** Handles input events for the combobox. */\n  onInput(event: Event) {\n    if (this.inputs.disabled() || this.inputs.readonly()) {\n      return;\n    }\n\n    const inputEl = this.inputs.inputEl();\n\n    if (!inputEl) {\n      return;\n    }\n\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return;\n    }\n\n    this.open();\n    this.inputs.inputValue?.set(inputEl.value);\n    this.isDeleting = event instanceof InputEvent && !!event.inputType.match(/^delete/);\n\n    if (this.inputs.filterMode() === 'highlight' && !this.isDeleting) {\n      this.highlight();\n    }\n  }\n\n  /** Handles focus in events for the combobox. */\n  onFocusIn() {\n    if (this.inputs.alwaysExpanded() && !this.hasBeenFocused()) {\n      const firstSelectedItem = this.listControls()?.getSelectedItems()[0];\n      firstSelectedItem ? this.listControls()?.focus(firstSelectedItem) : this.first();\n    }\n\n    this.isFocused.set(true);\n    this.hasBeenFocused.set(true);\n  }\n\n  /** Handles focus out events for the combobox. */\n  onFocusOut(event: FocusEvent) {\n    if (this.inputs.disabled()) {\n      return;\n    }\n\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return;\n    }\n\n    if (\n      !(event.relatedTarget instanceof HTMLElement) ||\n      !this.inputs.containerEl()?.contains(event.relatedTarget)\n    ) {\n      this.isFocused.set(false);\n\n      if (!this.expanded()) {\n        return;\n      }\n\n      if (this.readonly()) {\n        this.close();\n        return;\n      }\n\n      if (this.inputs.filterMode() !== 'manual') {\n        this.commit();\n      } else {\n        const item = popupControls\n          ?.items()\n          .find(i => i.searchTerm() === this.inputs.inputEl()?.value);\n\n        if (item) {\n          this.select({item});\n        }\n      }\n\n      this.close();\n    }\n  }\n\n  /** The first matching item in the combobox. */\n  firstMatch = computed(() => {\n    // TODO(wagnermaciel): Consider whether we should not provide this default behavior for the\n    // listbox. Instead, we may want to allow users to have no match so that typing does not focus\n    // any option.\n    if (this.listControls()?.role() === 'listbox') {\n      return this.listControls()?.items()[0];\n    }\n\n    return this.listControls()\n      ?.items()\n      .find(i => i.value() === this.inputs.firstMatch());\n  });\n\n  /** Handles filtering logic for the combobox. */\n  onFilter() {\n    if (this.readonly()) {\n      return;\n    }\n\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return;\n    }\n\n    // TODO(wagnermaciel)\n    // When the user first interacts with the combobox, the popup will lazily render for the first\n    // time. This is a simple way to detect this and avoid auto-focus & selection logic, but this\n    // should probably be moved to the component layer instead.\n    const isInitialRender = !this.inputs.inputValue?.().length && !this.isDeleting;\n\n    if (isInitialRender) {\n      return;\n    }\n\n    // Avoid refocusing the input if a filter event occurs after focus has left the combobox.\n    if (!this.isFocused()) {\n      return;\n    }\n\n    if (this.inputs.popupControls()?.role() === 'tree') {\n      const treeControls = this.inputs.popupControls() as ComboboxTreeControls<T, V>;\n      this.inputs.inputValue?.().length ? treeControls.expandAll() : treeControls.collapseAll();\n    }\n\n    const item = this.firstMatch();\n\n    if (!item) {\n      popupControls?.clearSelection();\n      popupControls?.unfocus();\n      return;\n    }\n\n    popupControls?.focus(item);\n\n    if (this.inputs.filterMode() !== 'manual') {\n      this.select({item});\n    }\n\n    if (this.inputs.filterMode() === 'highlight' && !this.isDeleting) {\n      this.highlight();\n    }\n  }\n\n  /** Highlights the currently selected item in the combobox. */\n  highlight() {\n    const inputEl = this.inputs.inputEl();\n    const selectedItems = this.listControls()?.getSelectedItems();\n    const item = selectedItems?.[0];\n\n    if (!inputEl || !item) {\n      return;\n    }\n\n    const isHighlightable = item\n      .searchTerm()\n      .toLowerCase()\n      .startsWith(this.inputs.inputValue!().toLowerCase());\n\n    if (isHighlightable) {\n      inputEl.value =\n        this.inputs.inputValue!() + item.searchTerm().slice(this.inputs.inputValue!().length);\n      inputEl.setSelectionRange(this.inputs.inputValue!().length, item.searchTerm().length);\n      this.highlightedItem.set(item);\n    }\n  }\n\n  /** Closes the combobox. */\n  close(opts?: {reset: boolean}) {\n    const popupControls = this.inputs.popupControls();\n\n    if (this.inputs.alwaysExpanded()) {\n      return;\n    }\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      this.expanded.set(false);\n      return;\n    }\n\n    if (this.readonly()) {\n      this.expanded.set(false);\n      popupControls?.unfocus();\n      return;\n    }\n\n    if (!opts?.reset) {\n      if (this.inputs.filterMode() === 'manual') {\n        if (\n          !this.listControls()\n            ?.items()\n            .some(i => i.searchTerm() === this.inputs.inputEl()?.value)\n        ) {\n          this.listControls()?.clearSelection();\n        }\n      }\n\n      this.expanded.set(false);\n      popupControls?.unfocus();\n      return;\n    }\n\n    if (!this.expanded()) {\n      this.inputs.inputValue?.set('');\n      popupControls?.clearSelection();\n\n      const inputEl = this.inputs.inputEl();\n\n      if (inputEl) {\n        inputEl.value = '';\n      }\n    } else if (this.expanded()) {\n      this.expanded.set(false);\n      const selectedItem = popupControls?.getSelectedItems()?.[0];\n\n      if (selectedItem?.searchTerm() !== this.inputs.inputValue!()) {\n        popupControls?.clearSelection();\n      }\n\n      return;\n    }\n\n    this.close();\n\n    if (!this.readonly()) {\n      popupControls?.clearSelection();\n    }\n  }\n\n  /** Opens the combobox. */\n  open(nav?: {first?: boolean; last?: boolean; selected?: boolean}) {\n    this.expanded.set(true);\n    const popupControls = this.inputs.popupControls();\n\n    if (popupControls instanceof ComboboxDialogPattern) {\n      return;\n    }\n\n    const inputEl = this.inputs.inputEl();\n\n    if (inputEl && this.inputs.filterMode() === 'highlight') {\n      const isHighlighting = inputEl.selectionStart !== inputEl.value.length;\n      this.inputs.inputValue?.set(inputEl.value.slice(0, inputEl.selectionStart || 0));\n      if (!isHighlighting) {\n        this.highlightedItem.set(undefined);\n      }\n    }\n\n    if (nav?.first) {\n      this.first();\n    }\n    if (nav?.last) {\n      this.last();\n    }\n    if (nav?.selected) {\n      const selectedItem = popupControls\n        ?.items()\n        .find(i => popupControls?.getSelectedItems().includes(i));\n\n      if (selectedItem) {\n        popupControls?.focus(selectedItem);\n      }\n    }\n  }\n\n  /** Navigates to the next focusable item in the combobox popup. */\n  next() {\n    this._navigate(() => this.listControls()?.next());\n  }\n\n  /** Navigates to the previous focusable item in the combobox popup. */\n  prev() {\n    this._navigate(() => this.listControls()?.prev());\n  }\n\n  /** Navigates to the first focusable item in the combobox popup. */\n  first() {\n    this._navigate(() => this.listControls()?.first());\n  }\n\n  /** Navigates to the last focusable item in the combobox popup. */\n  last() {\n    this._navigate(() => this.listControls()?.last());\n  }\n\n  /** Collapses the currently focused item in the combobox. */\n  collapseItem() {\n    const controls = this.inputs.popupControls() as ComboboxTreeControls<T, V>;\n    this._navigate(() => controls?.collapseItem());\n  }\n\n  /** Expands the currently focused item in the combobox. */\n  expandItem() {\n    const controls = this.inputs.popupControls() as ComboboxTreeControls<T, V>;\n    this._navigate(() => controls?.expandItem());\n  }\n\n  /** Selects an item in the combobox popup. */\n  select(opts: {item?: T; commit?: boolean; close?: boolean} = {}) {\n    const controls = this.listControls();\n\n    const item = opts.item ?? controls?.getActiveItem();\n\n    if (item?.disabled()) {\n      return;\n    }\n\n    if (opts.item) {\n      controls?.focus(opts.item, {focusElement: false});\n    }\n\n    controls?.multi() ? controls.toggle(opts.item) : controls?.select(opts.item);\n\n    if (opts.commit) {\n      this.commit();\n    }\n    if (opts.close) {\n      this.close();\n    }\n  }\n\n  /** Updates the value of the input based on the currently selected item. */\n  commit() {\n    const inputEl = this.inputs.inputEl();\n    const selectedItems = this.listControls()?.getSelectedItems();\n\n    if (!inputEl) {\n      return;\n    }\n\n    inputEl.value = selectedItems?.map(i => i.searchTerm()).join(', ') || '';\n    this.inputs.inputValue?.set(inputEl.value);\n\n    if (this.inputs.filterMode() === 'highlight' && !this.readonly()) {\n      const length = inputEl.value.length;\n      inputEl.setSelectionRange(length, length);\n    }\n  }\n\n  /** Navigates and handles additional actions based on filter mode. */\n  private _navigate(operation: () => void) {\n    operation();\n\n    if (this.inputs.filterMode() !== 'manual') {\n      this.select();\n    }\n\n    if (this.inputs.filterMode() === 'highlight') {\n      // This is to handle when the user navigates back to the originally highlighted item.\n      // E.g. User types \"Al\", highlights \"Alice\", then navigates down and back up to \"Alice\".\n      const selectedItem = this.listControls()?.getSelectedItems()[0];\n\n      if (!selectedItem) {\n        return;\n      }\n\n      if (selectedItem === this.highlightedItem()) {\n        this.highlight();\n      } else {\n        const inputEl = this.inputs.inputEl()!;\n        inputEl.value = selectedItem?.searchTerm()!;\n      }\n    }\n  }\n}\n\nexport class ComboboxDialogPattern {\n  id = () => this.inputs.id();\n\n  role = () => 'dialog' as const;\n\n  keydown = computed(() => {\n    return new KeyboardEventManager().on('Escape', () => this.inputs.combobox.close());\n  });\n\n  constructor(\n    readonly inputs: {\n      combobox: ComboboxPattern<any, any>;\n      element: SignalLike<HTMLDialogElement>;\n      id: SignalLike<string>;\n    },\n  ) {}\n\n  onKeydown(event: KeyboardEvent) {\n    this.keydown().handle(event);\n  }\n\n  onClick(event: MouseEvent) {\n    // The \"click\" event fires on the dialog when the user clicks outside of the dialog content.\n    if (event.target === this.inputs.element()) {\n      this.inputs.combobox.close();\n    }\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, Signal, signal} from '@angular/core';\nimport {KeyboardEventManager} from '../behaviors/event-manager';\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport {List, ListInputs, ListItem} from '../behaviors/list/list';\n\n/** The inputs for the MenuBarPattern class. */\nexport interface MenuBarInputs<V> extends ListInputs<MenuItemPattern<V>, V> {\n  /** The menu items contained in the menu. */\n  items: SignalLike<MenuItemPattern<V>[]>;\n\n  /** Callback function triggered when a menu item is selected. */\n  onSelect?: (value: V) => void;\n\n  /** The text direction of the menu bar. */\n  textDirection: SignalLike<'ltr' | 'rtl'>;\n}\n\n/** The inputs for the MenuPattern class. */\nexport interface MenuInputs<V> extends Omit<ListInputs<MenuItemPattern<V>, V>, 'values'> {\n  /** The unique ID of the menu. */\n  id: SignalLike<string>;\n\n  /** The menu items contained in the menu. */\n  items: SignalLike<MenuItemPattern<V>[]>;\n\n  /** A reference to the parent menu or menu trigger. */\n  parent: SignalLike<MenuTriggerPattern<V> | MenuItemPattern<V> | undefined>;\n\n  /** Callback function triggered when a menu item is selected. */\n  onSelect?: (value: V) => void;\n\n  /** The text direction of the menu bar. */\n  textDirection: SignalLike<'ltr' | 'rtl'>;\n\n  /** The delay in milliseconds before expanding sub-menus on hover. */\n  expansionDelay: SignalLike<number>;\n}\n\n/** The inputs for the MenuTriggerPattern class. */\nexport interface MenuTriggerInputs<V> {\n  /** A reference to the menu trigger element. */\n  element: SignalLike<HTMLElement | undefined>;\n\n  /** A reference to the menu associated with the trigger. */\n  menu: SignalLike<MenuPattern<V> | undefined>;\n\n  /** The text direction of the menu bar. */\n  textDirection: SignalLike<'ltr' | 'rtl'>;\n\n  /** Whether the menu trigger is disabled. */\n  disabled: SignalLike<boolean>;\n}\n\n/** The inputs for the MenuItemPattern class. */\nexport interface MenuItemInputs<V> extends Omit<ListItem<V>, 'index' | 'selectable'> {\n  /** A reference to the parent menu or menu trigger. */\n  parent: SignalLike<MenuPattern<V> | MenuBarPattern<V> | undefined>;\n\n  /** A reference to the submenu associated with the menu item. */\n  submenu: SignalLike<MenuPattern<V> | undefined>;\n}\n\n/** The menu ui pattern class. */\nexport class MenuPattern<V> {\n  /** The unique ID of the menu. */\n  id: SignalLike<string>;\n\n  /** The role of the menu. */\n  role = () => 'menu';\n\n  /** Whether the menu is disabled. */\n  disabled = () => this.inputs.disabled();\n\n  /** Whether the menu is visible. */\n  visible = computed(() => (this.inputs.parent() ? !!this.inputs.parent()?.expanded() : true));\n\n  /** Controls list behavior for the menu items. */\n  listBehavior: List<MenuItemPattern<V>, V>;\n\n  /** Whether the menu or any of its child elements are currently focused. */\n  isFocused = signal(false);\n\n  /** Whether the menu has received focus. */\n  hasBeenFocused = signal(false);\n\n  /** Whether the menu trigger has been hovered. */\n  hasBeenHovered = signal(false);\n\n  /** Timeout used to open sub-menus on hover. */\n  _openTimeout: any;\n\n  /** Timeout used to close sub-menus on hover out. */\n  _closeTimeout: any;\n\n  /** The tab index of the menu. */\n  tabIndex = () => this.listBehavior.tabIndex();\n\n  /** Whether the menu should be focused on mouse over. */\n  shouldFocus = computed(() => {\n    const root = this.root();\n\n    if (root instanceof MenuTriggerPattern) {\n      return true;\n    }\n\n    if (root instanceof MenuBarPattern || root instanceof MenuPattern) {\n      return root.isFocused();\n    }\n\n    return false;\n  });\n\n  /** The key used to expand sub-menus. */\n  private _expandKey = computed(() => {\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The key used to collapse sub-menus. */\n  private _collapseKey = computed(() => {\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** Represents the space key. Does nothing when the user is actively using typeahead. */\n  dynamicSpaceKey = computed(() => (this.listBehavior.isTyping() ? '' : ' '));\n\n  /** The regexp used to decide if a key should trigger typeahead. */\n  typeaheadRegexp = /^.$/;\n\n  /** The root of the menu. */\n  root: Signal<MenuTriggerPattern<V> | MenuBarPattern<V> | MenuPattern<V> | undefined> = computed(\n    () => {\n      const parent = this.inputs.parent();\n\n      if (!parent) {\n        return this;\n      }\n\n      if (parent instanceof MenuTriggerPattern) {\n        return parent;\n      }\n\n      const grandparent = parent.inputs.parent();\n\n      if (grandparent instanceof MenuBarPattern) {\n        return grandparent;\n      }\n\n      return grandparent?.root();\n    },\n  );\n\n  /** Handles keyboard events for the menu. */\n  keydownManager = computed(() => {\n    return new KeyboardEventManager()\n      .on('ArrowDown', () => this.next())\n      .on('ArrowUp', () => this.prev())\n      .on('Home', () => this.first())\n      .on('End', () => this.last())\n      .on('Enter', () => this.trigger())\n      .on('Escape', () => this.closeAll())\n      .on(this._expandKey, () => this.expand())\n      .on(this._collapseKey, () => this.collapse())\n      .on(this.dynamicSpaceKey, () => this.trigger())\n      .on(this.typeaheadRegexp, e => this.listBehavior.search(e.key));\n  });\n\n  constructor(readonly inputs: MenuInputs<V>) {\n    this.id = inputs.id;\n    this.listBehavior = new List<MenuItemPattern<V>, V>({\n      ...inputs,\n      values: signal([]),\n    });\n  }\n\n  /** Sets the default state for the menu. */\n  setDefaultState() {\n    if (!this.inputs.parent()) {\n      this.listBehavior.goto(this.inputs.items()[0], {focusElement: false});\n    }\n  }\n\n  /** Handles keyboard events for the menu. */\n  onKeydown(event: KeyboardEvent) {\n    this.keydownManager().handle(event);\n  }\n\n  /** Handles mouseover events for the menu. */\n  onMouseOver(event: MouseEvent) {\n    if (!this.visible()) {\n      return;\n    }\n\n    this.hasBeenHovered.set(true);\n    const item = this.inputs.items().find(i => i.element()?.contains(event.target as Node));\n\n    if (!item) {\n      return;\n    }\n\n    const parent = this.inputs.parent();\n    const activeItem = this?.inputs.activeItem();\n\n    if (parent instanceof MenuItemPattern) {\n      const grandparent = parent.inputs.parent();\n      if (grandparent instanceof MenuPattern) {\n        grandparent._clearTimeouts();\n        grandparent.listBehavior.goto(parent, {focusElement: false});\n      }\n    }\n\n    if (activeItem && activeItem !== item) {\n      this._closeItem(activeItem);\n    }\n\n    if (item.expanded()) {\n      this._clearCloseTimeout();\n    }\n\n    this._openItem(item);\n    this.listBehavior.goto(item, {focusElement: this.shouldFocus()});\n  }\n\n  /** Closes the specified menu item after a delay. */\n  private _closeItem(item: MenuItemPattern<V>) {\n    this._clearOpenTimeout();\n\n    if (!this._closeTimeout) {\n      this._closeTimeout = setTimeout(() => {\n        item.close();\n        this._closeTimeout = undefined;\n      }, this.inputs.expansionDelay());\n    }\n  }\n\n  /** Opens the specified menu item after a delay. */\n  private _openItem(item: MenuItemPattern<V>) {\n    this._clearOpenTimeout();\n\n    this._openTimeout = setTimeout(() => {\n      item.open();\n      this._openTimeout = undefined;\n    }, this.inputs.expansionDelay());\n  }\n\n  /** Handles mouseout events for the menu. */\n  onMouseOut(event: MouseEvent) {\n    this._clearOpenTimeout();\n\n    if (this.isFocused()) {\n      return;\n    }\n\n    const root = this.root();\n    const parent = this.inputs.parent();\n    const relatedTarget = event.relatedTarget as Node | null;\n\n    if (!root || !parent || parent instanceof MenuTriggerPattern) {\n      return;\n    }\n\n    const grandparent = parent.inputs.parent();\n\n    if (!grandparent || grandparent instanceof MenuBarPattern) {\n      return;\n    }\n\n    if (!grandparent.inputs.element()?.contains(relatedTarget)) {\n      parent.close();\n    }\n  }\n\n  /** Handles click events for the menu. */\n  onClick(event: MouseEvent) {\n    const relatedTarget = event.target as Node | null;\n    const item = this.inputs.items().find(i => i.element()?.contains(relatedTarget));\n\n    if (item) {\n      item.open();\n      this.listBehavior.goto(item);\n      this.submit(item);\n    }\n  }\n\n  /** Handles focusin events for the menu. */\n  onFocusIn() {\n    this.isFocused.set(true);\n    this.hasBeenFocused.set(true);\n  }\n\n  /** Handles the focusout event for the menu. */\n  onFocusOut(event: FocusEvent) {\n    const parent = this.inputs.parent();\n    const parentEl = parent?.inputs.element();\n    const relatedTarget = event.relatedTarget as Node | null;\n\n    if (!relatedTarget) {\n      this.isFocused.set(false);\n      this.inputs.parent()?.close({refocus: true});\n    }\n\n    if (parent instanceof MenuItemPattern) {\n      const grandparent = parent.inputs.parent();\n      const siblings = grandparent?.inputs.items().filter(i => i !== parent);\n      const item = siblings?.find(i => i.element()?.contains(relatedTarget));\n\n      if (item) {\n        return;\n      }\n    }\n\n    if (\n      this.visible() &&\n      !parentEl?.contains(relatedTarget) &&\n      !this.inputs.element()?.contains(relatedTarget)\n    ) {\n      this.isFocused.set(false);\n      this.inputs.parent()?.close();\n    }\n  }\n\n  /** Focuses the previous menu item. */\n  prev() {\n    this.inputs.activeItem()?.close();\n    this.listBehavior.prev();\n  }\n\n  /** Focuses the next menu item. */\n  next() {\n    this.inputs.activeItem()?.close();\n    this.listBehavior.next();\n  }\n\n  /** Focuses the first menu item. */\n  first() {\n    this.inputs.activeItem()?.close();\n    this.listBehavior.first();\n  }\n\n  /** Focuses the last menu item. */\n  last() {\n    this.inputs.activeItem()?.close();\n    this.listBehavior.last();\n  }\n\n  /** Triggers the active menu item. */\n  trigger() {\n    this.inputs.activeItem()?.hasPopup()\n      ? this.inputs.activeItem()?.open({first: true})\n      : this.submit();\n  }\n\n  /** Submits the menu. */\n  submit(item = this.inputs.activeItem()) {\n    const root = this.root();\n\n    if (item && !item.disabled()) {\n      const isMenu = root instanceof MenuPattern;\n      const isMenuBar = root instanceof MenuBarPattern;\n      const isMenuTrigger = root instanceof MenuTriggerPattern;\n\n      if (!item.submenu() && isMenuTrigger) {\n        root.close({refocus: true});\n      }\n\n      if (!item.submenu() && isMenuBar) {\n        root.close();\n        root?.inputs.onSelect?.(item.value());\n      }\n\n      if (!item.submenu() && isMenu) {\n        root.inputs.activeItem()?.close({refocus: true});\n        root?.inputs.onSelect?.(item.value());\n      }\n    }\n  }\n\n  /** Collapses the current menu or focuses the previous item in the menubar. */\n  collapse() {\n    const root = this.root();\n    const parent = this.inputs.parent();\n\n    if (parent instanceof MenuItemPattern && !(parent.inputs.parent() instanceof MenuBarPattern)) {\n      parent.close({refocus: true});\n    } else if (root instanceof MenuBarPattern) {\n      root.prev();\n    }\n  }\n\n  /** Expands the current menu or focuses the next item in the menubar. */\n  expand() {\n    const root = this.root();\n    const activeItem = this.inputs.activeItem();\n\n    if (activeItem?.submenu()) {\n      activeItem.open({first: true});\n    } else if (root instanceof MenuBarPattern) {\n      root.next();\n    }\n  }\n\n  /** Closes the menu. */\n  close() {\n    this.inputs.parent()?.close();\n  }\n\n  /** Closes the menu and all parent menus. */\n  closeAll() {\n    const root = this.root();\n\n    if (root instanceof MenuTriggerPattern) {\n      root.close({refocus: true});\n    }\n\n    if (root instanceof MenuBarPattern) {\n      root.close();\n    }\n\n    if (root instanceof MenuPattern) {\n      root.inputs.activeItem()?.close({refocus: true});\n    }\n  }\n\n  /** Clears any open or close timeouts for sub-menus. */\n  _clearTimeouts() {\n    this._clearOpenTimeout();\n    this._clearCloseTimeout();\n  }\n\n  /** Clears the open timeout. */\n  _clearOpenTimeout() {\n    if (this._openTimeout) {\n      clearTimeout(this._openTimeout);\n      this._openTimeout = undefined;\n    }\n  }\n\n  /** Clears the close timeout. */\n  _clearCloseTimeout() {\n    if (this._closeTimeout) {\n      clearTimeout(this._closeTimeout);\n      this._closeTimeout = undefined;\n    }\n  }\n}\n\n/** The menubar ui pattern class. */\nexport class MenuBarPattern<V> {\n  /** Controls list behavior for the menu items. */\n  listBehavior: List<MenuItemPattern<V>, V>;\n\n  /** The tab index of the menu. */\n  tabIndex = () => this.listBehavior.tabIndex();\n\n  /** The key used to navigate to the next item. */\n  private _nextKey = computed(() => {\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The key used to navigate to the previous item. */\n  private _previousKey = computed(() => {\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** Represents the space key. Does nothing when the user is actively using typeahead. */\n  dynamicSpaceKey = computed(() => (this.listBehavior.isTyping() ? '' : ' '));\n\n  /** The regexp used to decide if a key should trigger typeahead. */\n  typeaheadRegexp = /^.$/;\n\n  /** Whether the menubar or any of its children are currently focused. */\n  isFocused = signal(false);\n\n  /** Whether the menubar has been focused. */\n  hasBeenFocused = signal(false);\n\n  /** Whether the menubar is disabled. */\n  disabled = () => this.inputs.disabled();\n\n  /** Handles keyboard events for the menu. */\n  keydownManager = computed(() => {\n    return new KeyboardEventManager()\n      .on(this._nextKey, () => this.next())\n      .on(this._previousKey, () => this.prev())\n      .on('End', () => this.listBehavior.last())\n      .on('Home', () => this.listBehavior.first())\n      .on('Enter', () => this.inputs.activeItem()?.open({first: true}))\n      .on('ArrowUp', () => this.inputs.activeItem()?.open({last: true}))\n      .on('ArrowDown', () => this.inputs.activeItem()?.open({first: true}))\n      .on(this.dynamicSpaceKey, () => this.inputs.activeItem()?.open({first: true}))\n      .on(this.typeaheadRegexp, e => this.listBehavior.search(e.key));\n  });\n\n  constructor(readonly inputs: MenuBarInputs<V>) {\n    this.listBehavior = new List<MenuItemPattern<V>, V>(inputs);\n  }\n\n  /** Sets the default state for the menubar. */\n  setDefaultState() {\n    this.inputs.activeItem.set(this.inputs.items()[0]);\n  }\n\n  /** Handles keyboard events for the menu. */\n  onKeydown(event: KeyboardEvent) {\n    this.keydownManager().handle(event);\n  }\n\n  /** Handles click events for the menu bar. */\n  onClick(event: MouseEvent) {\n    const item = this.inputs.items().find(i => i.element()?.contains(event.target as Node));\n\n    if (!item) {\n      return;\n    }\n\n    this.goto(item);\n    item.expanded() ? item.close() : item.open();\n  }\n\n  /** Handles mouseover events for the menu bar. */\n  onMouseOver(event: MouseEvent) {\n    const item = this.inputs.items().find(i => i.element()?.contains(event.target as Node));\n\n    if (item) {\n      this.goto(item, {focusElement: this.isFocused()});\n    }\n  }\n\n  /** Handles focusin events for the menu bar. */\n  onFocusIn() {\n    this.isFocused.set(true);\n    this.hasBeenFocused.set(true);\n  }\n\n  /** Handles focusout events for the menu bar. */\n  onFocusOut(event: FocusEvent) {\n    const relatedTarget = event.relatedTarget as Node | null;\n\n    if (!this.inputs.element()?.contains(relatedTarget)) {\n      this.isFocused.set(false);\n      this.close();\n    }\n  }\n\n  /** Goes to and optionally focuses the specified menu item. */\n  goto(item: MenuItemPattern<V>, opts?: {focusElement?: boolean}) {\n    const prevItem = this.inputs.activeItem();\n    this.listBehavior.goto(item, opts);\n\n    if (prevItem?.expanded()) {\n      prevItem?.close();\n      this.inputs.activeItem()?.open();\n    }\n\n    if (item === prevItem) {\n      if (item.expanded() && item.submenu()?.inputs.activeItem()) {\n        item.submenu()?.inputs.activeItem()?.close();\n        item.submenu()?.listBehavior.unfocus();\n      }\n    }\n  }\n\n  /** Focuses the next menu item. */\n  next() {\n    const prevItem = this.inputs.activeItem();\n    this.listBehavior.next();\n\n    if (prevItem?.expanded()) {\n      prevItem?.close();\n      this.inputs.activeItem()?.open({first: true});\n    }\n  }\n\n  /** Focuses the previous menu item. */\n  prev() {\n    const prevItem = this.inputs.activeItem();\n    this.listBehavior.prev();\n\n    if (prevItem?.expanded()) {\n      prevItem?.close();\n      this.inputs.activeItem()?.open({first: true});\n    }\n  }\n\n  /** Closes the menubar and refocuses the root menu bar item. */\n  close() {\n    this.inputs.activeItem()?.close({refocus: this.isFocused()});\n  }\n}\n\n/** The menu trigger ui pattern class. */\nexport class MenuTriggerPattern<V> {\n  /** Whether the menu is expanded. */\n  expanded = signal(false);\n\n  /** Whether the menu trigger has received focus. */\n  hasBeenFocused = signal(false);\n\n  /** The role of the menu trigger. */\n  role = () => 'button';\n\n  /** Whether the menu trigger has a popup. */\n  hasPopup = () => true;\n\n  /** The menu associated with the trigger. */\n  menu: SignalLike<MenuPattern<V> | undefined>;\n\n  /** The tab index of the menu trigger. */\n  tabIndex = computed(() => (this.expanded() && this.menu()?.inputs.activeItem() ? -1 : 0));\n\n  /** Whether the menu trigger is disabled. */\n  disabled = () => this.inputs.disabled();\n\n  /** Handles keyboard events for the menu trigger. */\n  keydownManager = computed(() => {\n    return new KeyboardEventManager()\n      .on(' ', () => this.open({first: true}))\n      .on('Enter', () => this.open({first: true}))\n      .on('ArrowDown', () => this.open({first: true}))\n      .on('ArrowUp', () => this.open({last: true}))\n      .on('Escape', () => this.close({refocus: true}));\n  });\n\n  constructor(readonly inputs: MenuTriggerInputs<V>) {\n    this.menu = this.inputs.menu;\n  }\n\n  /** Handles keyboard events for the menu trigger. */\n  onKeydown(event: KeyboardEvent) {\n    if (!this.inputs.disabled()) {\n      this.keydownManager().handle(event);\n    }\n  }\n\n  /** Handles click events for the menu trigger. */\n  onClick() {\n    if (!this.inputs.disabled()) {\n      this.expanded() ? this.close() : this.open({first: true});\n    }\n  }\n\n  /** Handles focusin events for the menu trigger. */\n  onFocusIn() {\n    this.hasBeenFocused.set(true);\n  }\n\n  /** Handles focusout events for the menu trigger. */\n  onFocusOut(event: FocusEvent) {\n    const element = this.inputs.element();\n    const relatedTarget = event.relatedTarget as Node | null;\n\n    if (\n      this.expanded() &&\n      !element?.contains(relatedTarget) &&\n      !this.inputs.menu()?.inputs.element()?.contains(relatedTarget)\n    ) {\n      this.close();\n    }\n  }\n\n  /** Opens the menu. */\n  open(opts?: {first?: boolean; last?: boolean}) {\n    this.expanded.set(true);\n\n    if (opts?.first) {\n      this.inputs.menu()?.first();\n    } else if (opts?.last) {\n      this.inputs.menu()?.last();\n    }\n  }\n\n  /** Closes the menu. */\n  close(opts: {refocus?: boolean} = {}) {\n    this.expanded.set(false);\n    this.menu()?.listBehavior.unfocus();\n\n    if (opts.refocus) {\n      this.inputs.element()?.focus();\n    }\n\n    let menuitems = this.inputs.menu()?.inputs.items() ?? [];\n\n    while (menuitems.length) {\n      const menuitem = menuitems.pop();\n      menuitem?._expanded.set(false);\n      menuitem?.inputs.parent()?.listBehavior.unfocus();\n      menuitems = menuitems.concat(menuitem?.submenu()?.inputs.items() ?? []);\n    }\n  }\n}\n\n/** The menu item ui pattern class. */\nexport class MenuItemPattern<V> implements ListItem<V> {\n  /** The value of the menu item. */\n  value: SignalLike<V>;\n\n  /** The unique ID of the menu item. */\n  id: SignalLike<string>;\n\n  /** Whether the menu item is disabled. */\n  disabled = () => this.inputs.parent()?.disabled() || this.inputs.disabled();\n\n  /** The search term for the menu item. */\n  searchTerm: SignalLike<string>;\n\n  /** The element of the menu item. */\n  element: SignalLike<HTMLElement | undefined>;\n\n  /** Whether the menu item is active. */\n  active = computed(() => this.inputs.parent()?.inputs.activeItem() === this);\n\n  /** Whether the menu item has received focus. */\n  hasBeenFocused = signal(false);\n\n  /** The tab index of the menu item. */\n  tabIndex = computed(() => {\n    if (this.submenu() && this.submenu()?.inputs.activeItem()) {\n      return -1;\n    }\n    return this.inputs.parent()?.listBehavior.getItemTabindex(this) ?? -1;\n  });\n\n  /** The position of the menu item in the menu. */\n  index = computed(() => this.inputs.parent()?.inputs.items().indexOf(this) ?? -1);\n\n  /** Whether the menu item is expanded. */\n  expanded = computed(() => (this.submenu() ? this._expanded() : null));\n\n  /** Whether the menu item is expanded. */\n  _expanded = signal(false);\n\n  /** The ID of the menu that the menu item controls. */\n  controls = signal<string | undefined>(undefined);\n\n  /** The role of the menu item. */\n  role = () => 'menuitem';\n\n  /** Whether the menu item has a popup. */\n  hasPopup = computed(() => !!this.submenu());\n\n  /** The submenu associated with the menu item. */\n  submenu: SignalLike<MenuPattern<V> | undefined>;\n\n  /** Whether the menu item is selectable. */\n  selectable: SignalLike<boolean>;\n\n  constructor(readonly inputs: MenuItemInputs<V>) {\n    this.id = inputs.id;\n    this.value = inputs.value;\n    this.element = inputs.element;\n    this.submenu = this.inputs.submenu;\n    this.searchTerm = inputs.searchTerm;\n    this.selectable = computed(() => !this.submenu());\n  }\n\n  /** Opens the submenu. */\n  open(opts?: {first?: boolean; last?: boolean}) {\n    if (this.disabled()) {\n      return;\n    }\n\n    this._expanded.set(true);\n\n    if (opts?.first) {\n      this.submenu()?.first();\n    }\n    if (opts?.last) {\n      this.submenu()?.last();\n    }\n  }\n\n  /** Closes the submenu. */\n  close(opts: {refocus?: boolean} = {}) {\n    this._expanded.set(false);\n\n    if (opts.refocus) {\n      this.inputs.parent()?.listBehavior.goto(this);\n    }\n\n    let menuitems = this.inputs.submenu()?.inputs.items() ?? [];\n\n    while (menuitems.length) {\n      const menuitem = menuitems.pop();\n      menuitem?._expanded.set(false);\n      menuitem?.inputs.parent()?.listBehavior.unfocus();\n      menuitems = menuitems.concat(menuitem?.submenu()?.inputs.items() ?? []);\n\n      const parent = menuitem?.inputs.parent();\n\n      if (parent instanceof MenuPattern) {\n        parent._clearTimeouts();\n      }\n    }\n  }\n\n  /** Handles focusin events for the menu item. */\n  onFocusIn() {\n    this.hasBeenFocused.set(true);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nexport type SignalLike<T> = () => T;\n\nexport interface WritableSignalLike<T> extends SignalLike<T> {\n  set(value: T): void;\n  update(updateFn: (value: T) => T): void;\n}\n\n/** Converts a getter setter style signal to a WritableSignalLike. */\nexport function convertGetterSetterToWritableSignalLike<T>(\n  getter: () => T,\n  setter: (v: T) => void,\n): WritableSignalLike<T> {\n  // tslint:disable-next-line:ban Have to use `Object.assign` to preserve the getter function.\n  return Object.assign(getter, {\n    set: setter,\n    update: (updateCallback: (v: T) => T) => setter(updateCallback(getter())),\n  });\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\nimport {SignalLike, WritableSignalLike} from '../signal-like/signal-like';\n\n/** Represents an item that can be expanded or collapsed. */\nexport interface ExpansionItem {\n  /** Whether the item is expandable. */\n  expandable: SignalLike<boolean>;\n\n  /** Whether the item is expanded. */\n  expanded: WritableSignalLike<boolean>;\n\n  /** Whether the expansion is disabled. */\n  disabled: SignalLike<boolean>;\n}\n\n/** Represents the required inputs for an expansion behavior. */\nexport interface ListExpansionInputs {\n  /** Whether multiple items can be expanded at once. */\n  multiExpandable: SignalLike<boolean>;\n\n  /** An array of expansion items. */\n  items: SignalLike<ExpansionItem[]>;\n\n  /** Whether all expansions are disabled. */\n  disabled: SignalLike<boolean>;\n}\n\n/** Manages the expansion state of a list of items. */\nexport class ListExpansion {\n  constructor(readonly inputs: ListExpansionInputs) {}\n\n  /** Opens the specified item. */\n  open(item: ExpansionItem): boolean {\n    if (!this.isExpandable(item)) return false;\n    if (item.expanded()) return false;\n    if (!this.inputs.multiExpandable()) {\n      this.closeAll();\n    }\n    item.expanded.set(true);\n    return true;\n  }\n\n  /** Closes the specified item. */\n  close(item: ExpansionItem): boolean {\n    if (!this.isExpandable(item)) return false;\n\n    item.expanded.set(false);\n    return true;\n  }\n\n  /** Toggles the expansion state of the specified item. */\n  toggle(item: ExpansionItem): boolean {\n    return item.expanded() ? this.close(item) : this.open(item);\n  }\n\n  /** Opens all focusable items in the list. */\n  openAll(): void {\n    if (this.inputs.multiExpandable()) {\n      for (const item of this.inputs.items()) {\n        this.open(item);\n      }\n    }\n  }\n\n  /** Closes all focusable items in the list. */\n  closeAll(): void {\n    for (const item of this.inputs.items()) {\n      this.close(item);\n    }\n  }\n\n  /** Checks whether the specified item is expandable / collapsible. */\n  isExpandable(item: ExpansionItem) {\n    return !this.inputs.disabled() && !item.disabled() && item.expandable();\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\nimport {computed} from '@angular/core';\nimport {SignalLike} from '../signal-like/signal-like';\n\n/** Represents the required inputs for the label control. */\nexport interface LabelControlInputs {\n  /** The default `aria-labelledby` ids. */\n  defaultLabelledBy: SignalLike<string[]>;\n}\n\n/** Represents the optional inputs for the label control. */\nexport interface LabelControlOptionalInputs {\n  /** The `aria-label`. */\n  label?: SignalLike<string | undefined>;\n\n  /** The user-provided `aria-labelledby` ids. */\n  labelledBy?: SignalLike<string[]>;\n}\n\n/** Controls label and description of an element. */\nexport class LabelControl {\n  /** The `aria-label`. */\n  readonly label = computed(() => this.inputs.label?.());\n\n  /** The `aria-labelledby` ids. */\n  readonly labelledBy = computed(() => {\n    const label = this.label();\n    const labelledBy = this.inputs.labelledBy?.();\n    const defaultLabelledBy = this.inputs.defaultLabelledBy();\n\n    if (labelledBy && labelledBy.length > 0) {\n      return labelledBy;\n    }\n\n    // If an aria-label is provided by developers, do not set aria-labelledby with the\n    // defaultLabelledBy value because if both attributes are set, aria-labelledby will be used.\n    if (label) {\n      return [];\n    }\n\n    return defaultLabelledBy;\n  });\n\n  constructor(readonly inputs: LabelControlInputs & LabelControlOptionalInputs) {}\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed, signal, WritableSignal} from '@angular/core';\nimport {KeyboardEventManager, PointerEventManager} from '../behaviors/event-manager';\nimport {ExpansionItem, ListExpansionInputs, ListExpansion} from '../behaviors/expansion/expansion';\nimport {SignalLike, WritableSignalLike} from '../behaviors/signal-like/signal-like';\nimport {LabelControl, LabelControlOptionalInputs} from '../behaviors/label/label';\nimport {ListFocus} from '../behaviors/list-focus/list-focus';\nimport {\n  ListNavigationItem,\n  ListNavigation,\n  ListNavigationInputs,\n} from '../behaviors/list-navigation/list-navigation';\n\n/** The required inputs to tabs. */\nexport interface TabInputs\n  extends Omit<ListNavigationItem, 'index'>, Omit<ExpansionItem, 'expandable'> {\n  /** The parent tablist that controls the tab. */\n  tablist: SignalLike<TabListPattern>;\n\n  /** The remote tabpanel controlled by the tab. */\n  tabpanel: SignalLike<TabPanelPattern | undefined>;\n\n  /** The remote tabpanel unique identifier. */\n  value: SignalLike<string>;\n}\n\n/** A tab in a tablist. */\nexport class TabPattern {\n  /** A global unique identifier for the tab. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The index of the tab. */\n  readonly index = computed(() => this.inputs.tablist().inputs.items().indexOf(this));\n\n  /** The remote tabpanel unique identifier. */\n  readonly value: SignalLike<string> = () => this.inputs.value();\n\n  /** Whether the tab is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The html element that should receive focus. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether this tab has expandable panel. */\n  readonly expandable: SignalLike<boolean> = () => true;\n\n  /** Whether the tab panel is expanded. */\n  readonly expanded: WritableSignalLike<boolean>;\n\n  /** Whether the tab is active. */\n  readonly active = computed(() => this.inputs.tablist().inputs.activeItem() === this);\n\n  /** Whether the tab is selected. */\n  readonly selected = computed(() => this.inputs.tablist().selectedTab() === this);\n\n  /** The tab index of the tab. */\n  readonly tabIndex = computed(() => this.inputs.tablist().focusBehavior.getItemTabIndex(this));\n\n  /** The id of the tabpanel associated with the tab. */\n  readonly controls = computed(() => this.inputs.tabpanel()?.id());\n\n  constructor(readonly inputs: TabInputs) {\n    this.expanded = inputs.expanded;\n  }\n\n  /** Opens the tab. */\n  open(): boolean {\n    return this.inputs.tablist().open(this);\n  }\n}\n\n/** The required inputs for the tabpanel. */\nexport interface TabPanelInputs extends LabelControlOptionalInputs {\n  /** A global unique identifier for the tabpanel. */\n  id: SignalLike<string>;\n\n  /** The tab that controls this tabpanel. */\n  tab: SignalLike<TabPattern | undefined>;\n\n  /** A local unique identifier for the tabpanel. */\n  value: SignalLike<string>;\n}\n\n/** A tabpanel associated with a tab. */\nexport class TabPanelPattern {\n  /** A global unique identifier for the tabpanel. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** A local unique identifier for the tabpanel. */\n  readonly value: SignalLike<string> = () => this.inputs.value();\n\n  /** Controls label for this tabpanel. */\n  readonly labelManager: LabelControl;\n\n  /** Whether the tabpanel is hidden. */\n  readonly hidden = computed(() => this.inputs.tab()?.expanded() === false);\n\n  /** The tab index of this tabpanel. */\n  readonly tabIndex = computed(() => (this.hidden() ? -1 : 0));\n\n  /** The aria-labelledby value for this tabpanel. */\n  readonly labelledBy = computed(() =>\n    this.labelManager.labelledBy().length > 0\n      ? this.labelManager.labelledBy().join(' ')\n      : undefined,\n  );\n\n  constructor(readonly inputs: TabPanelInputs) {\n    this.labelManager = new LabelControl({\n      ...inputs,\n      defaultLabelledBy: computed(() => (this.inputs.tab() ? [this.inputs.tab()!.id()] : [])),\n    });\n  }\n}\n\n/** The required inputs for the tablist. */\nexport interface TabListInputs\n  extends\n    Omit<ListNavigationInputs<TabPattern>, 'multi'>,\n    Omit<ListExpansionInputs, 'multiExpandable' | 'items'> {\n  /** The selection strategy used by the tablist. */\n  selectionMode: SignalLike<'follow' | 'explicit'>;\n}\n\n/** Controls the state of a tablist. */\nexport class TabListPattern {\n  /** The list focus behavior for the tablist. */\n  readonly focusBehavior: ListFocus<TabPattern>;\n\n  /** The list navigation behavior for the tablist. */\n  readonly navigationBehavior: ListNavigation<TabPattern>;\n\n  /** Controls expansion for the tablist. */\n  readonly expansionBehavior: ListExpansion;\n\n  /** The currently active tab. */\n  readonly activeTab: SignalLike<TabPattern | undefined> = () => this.inputs.activeItem();\n\n  /** The currently selected tab. */\n  readonly selectedTab: WritableSignal<TabPattern | undefined> = signal(undefined);\n\n  /** Whether the tablist is vertically or horizontally oriented. */\n  readonly orientation: SignalLike<'vertical' | 'horizontal'> = () => this.inputs.orientation();\n\n  /** Whether the tablist is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The tab index of the tablist. */\n  readonly tabIndex = computed(() => this.focusBehavior.getListTabIndex());\n\n  /** The id of the current active tab. */\n  readonly activeDescendant = computed(() => this.focusBehavior.getActiveDescendant());\n\n  /** Whether selection should follow focus. */\n  readonly followFocus = computed(() => this.inputs.selectionMode() === 'follow');\n\n  /** The key used to navigate to the previous tab in the tablist. */\n  readonly prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key used to navigate to the next item in the list. */\n  readonly nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The keydown event manager for the tablist. */\n  readonly keydown = computed(() => {\n    return new KeyboardEventManager()\n      .on(this.prevKey, () =>\n        this._navigate(() => this.navigationBehavior.prev(), this.followFocus()),\n      )\n      .on(this.nextKey, () =>\n        this._navigate(() => this.navigationBehavior.next(), this.followFocus()),\n      )\n      .on('Home', () => this._navigate(() => this.navigationBehavior.first(), this.followFocus()))\n      .on('End', () => this._navigate(() => this.navigationBehavior.last(), this.followFocus()))\n      .on(' ', () => this.open())\n      .on('Enter', () => this.open());\n  });\n\n  /** The pointerdown event manager for the tablist. */\n  readonly pointerdown = computed(() => {\n    return new PointerEventManager().on(e =>\n      this._navigate(() => this.navigationBehavior.goto(this._getItem(e)!), true),\n    );\n  });\n\n  constructor(readonly inputs: TabListInputs) {\n    this.focusBehavior = new ListFocus(inputs);\n\n    this.navigationBehavior = new ListNavigation({\n      ...inputs,\n      focusManager: this.focusBehavior,\n    });\n\n    this.expansionBehavior = new ListExpansion({\n      ...inputs,\n      multiExpandable: () => false,\n    });\n  }\n\n  /**\n   * Sets the tablist to its default initial state.\n   *\n   * Sets the active index of the tablist to the first focusable selected\n   * tab if one exists. Otherwise, sets focus to the first focusable tab.\n   *\n   * This method should be called once the tablist and its tabs are properly initialized.\n   */\n  setDefaultState() {\n    let firstItem: TabPattern | undefined;\n\n    for (const item of this.inputs.items()) {\n      if (!this.focusBehavior.isFocusable(item)) continue;\n\n      if (firstItem === undefined) {\n        firstItem = item;\n      }\n\n      if (item.selected()) {\n        this.inputs.activeItem.set(item);\n        return;\n      }\n    }\n    if (firstItem !== undefined) {\n      this.inputs.activeItem.set(firstItem);\n    }\n  }\n\n  /** Handles keydown events for the tablist. */\n  onKeydown(event: KeyboardEvent) {\n    if (!this.disabled()) {\n      this.keydown().handle(event);\n    }\n  }\n\n  /** The pointerdown event manager for the tablist. */\n  onPointerdown(event: PointerEvent) {\n    if (!this.disabled()) {\n      this.pointerdown().handle(event);\n    }\n  }\n\n  /** Opens the tab by given value. */\n  open(value: string): boolean;\n\n  /** Opens the given tab or the current active tab. */\n  open(tab?: TabPattern): boolean;\n\n  open(tab: TabPattern | string | undefined): boolean {\n    tab ??= this.activeTab();\n\n    if (typeof tab === 'string') {\n      tab = this.inputs.items().find(t => t.value() === tab);\n    }\n\n    if (tab === undefined) return false;\n\n    const success = this.expansionBehavior.open(tab);\n    if (success) {\n      this.selectedTab.set(tab);\n    }\n\n    return success;\n  }\n\n  /** Executes a navigation operation and expand the active tab if needed. */\n  private _navigate(op: () => boolean, shouldExpand: boolean = false): void {\n    const success = op();\n    if (success && shouldExpand) {\n      this.open();\n    }\n  }\n\n  /** Returns the tab item associated with the given pointer event. */\n  private _getItem(e: PointerEvent) {\n    if (!(e.target instanceof HTMLElement)) {\n      return;\n    }\n\n    const element = e.target.closest('[role=\"tab\"]');\n    return this.inputs.items().find(i => i.element() === element);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed} from '@angular/core';\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport {KeyboardEventManager} from '../behaviors/event-manager';\nimport {List, ListInputs} from '../behaviors/list/list';\nimport {ToolbarWidgetPattern} from './toolbar-widget';\n\n/** Represents the required inputs for a toolbar. */\nexport type ToolbarInputs<V> = Omit<\n  ListInputs<ToolbarWidgetPattern<V>, V>,\n  'multi' | 'typeaheadDelay' | 'selectionMode' | 'focusMode'\n> & {\n  /** A function that returns the toolbar item associated with a given element. */\n  getItem: (e: Element) => ToolbarWidgetPattern<V> | undefined;\n};\n\n/** Controls the state of a toolbar. */\nexport class ToolbarPattern<V> {\n  /** The list behavior for the toolbar. */\n  readonly listBehavior: List<ToolbarWidgetPattern<V>, V>;\n\n  /** Whether the tablist is vertically or horizontally oriented. */\n  readonly orientation: SignalLike<'vertical' | 'horizontal'>;\n\n  /** Whether disabled items in the group should be focusable. */\n  readonly softDisabled: SignalLike<boolean>;\n\n  /** Whether the toolbar is disabled. */\n  readonly disabled = computed(() => this.listBehavior.disabled());\n\n  /** The tab index of the toolbar (if using activedescendant). */\n  readonly tabIndex = computed(() => this.listBehavior.tabIndex());\n\n  /** The id of the current active widget (if using activedescendant). */\n  readonly activeDescendant = computed(() => this.listBehavior.activeDescendant());\n\n  /** The currently active item in the toolbar. */\n  readonly activeItem = () => this.listBehavior.inputs.activeItem();\n\n  /** The key used to navigate to the previous widget. */\n  private readonly _prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key used to navigate to the next widget. */\n  private readonly _nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The alternate key used to navigate to the previous widget. */\n  private readonly _altPrevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n    }\n    return 'ArrowUp';\n  });\n\n  /** The alternate key used to navigate to the next widget. */\n  private readonly _altNextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n    }\n    return 'ArrowDown';\n  });\n\n  /** The keydown event manager for the toolbar. */\n  private readonly _keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n\n    return manager\n      .on(this._nextKey, () => this.listBehavior.next())\n      .on(this._prevKey, () => this.listBehavior.prev())\n      .on(this._altNextKey, () => this._groupNext())\n      .on(this._altPrevKey, () => this._groupPrev())\n      .on(' ', () => this.select())\n      .on('Enter', () => this.select())\n      .on('Home', () => this.listBehavior.first())\n      .on('End', () => this.listBehavior.last());\n  });\n\n  /** Navigates to the next widget in a widget group. */\n  private _groupNext() {\n    const currGroup = this.inputs.activeItem()?.group();\n    const nextGroup = this.listBehavior.navigationBehavior.peekNext()?.group();\n\n    if (!currGroup) {\n      return;\n    }\n\n    if (currGroup !== nextGroup) {\n      this.listBehavior.goto(\n        this.listBehavior.navigationBehavior.peekFirst(currGroup.inputs.items())!,\n      );\n\n      return;\n    }\n\n    this.listBehavior.next();\n  }\n\n  /** Navigates to the previous widget in a widget group. */\n  private _groupPrev() {\n    const currGroup = this.inputs.activeItem()?.group();\n    const nextGroup = this.listBehavior.navigationBehavior.peekPrev()?.group();\n\n    if (!currGroup) {\n      return;\n    }\n\n    if (currGroup !== nextGroup) {\n      this.listBehavior.goto(\n        this.listBehavior.navigationBehavior.peekLast(currGroup.inputs.items())!,\n      );\n\n      return;\n    }\n\n    this.listBehavior.prev();\n  }\n\n  /** Navigates to the widget targeted by a pointer event. */\n  private _goto(e: MouseEvent) {\n    const item = this.inputs.getItem(e.target as Element);\n\n    if (item) {\n      this.listBehavior.goto(item);\n      this.select();\n    }\n  }\n\n  select() {\n    const group = this.inputs.activeItem()?.group();\n\n    if (!group?.multi()) {\n      group?.inputs.items().forEach(i => this.listBehavior.deselect(i));\n    }\n\n    this.listBehavior.toggle();\n  }\n\n  constructor(readonly inputs: ToolbarInputs<V>) {\n    this.orientation = inputs.orientation;\n    this.softDisabled = inputs.softDisabled;\n\n    this.listBehavior = new List({\n      ...inputs,\n      multi: () => true,\n      focusMode: () => 'roving',\n      selectionMode: () => 'explicit',\n      typeaheadDelay: () => 0, // Toolbar widgets do not support typeahead.\n    });\n  }\n\n  /** Handles keydown events for the toolbar. */\n  onKeydown(event: KeyboardEvent) {\n    if (this.disabled()) return;\n    this._keydown().handle(event);\n  }\n\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault();\n  }\n\n  /** Handles click events for the toolbar. */\n  onClick(event: MouseEvent) {\n    if (this.disabled()) return;\n    this._goto(event);\n  }\n\n  /**\n   * Sets the toolbar to its default initial state.\n   *\n   * Sets the active index to the selected widget if one exists and is focusable.\n   * Otherwise, sets the active index to the first focusable widget.\n   */\n  setDefaultState() {\n    const firstItem = this.listBehavior.navigationBehavior.peekFirst(this.inputs.items());\n\n    if (firstItem) {\n      this.inputs.activeItem.set(firstItem);\n    }\n  }\n\n  /** Validates the state of the toolbar and returns a list of accessibility violations. */\n  validate(): string[] {\n    const violations: string[] = [];\n    return violations;\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed} from '@angular/core';\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport {ListItem} from '../behaviors/list/list';\nimport type {ToolbarPattern} from './toolbar';\nimport {ToolbarWidgetGroupPattern} from './toolbar-widget-group';\n\n/** Represents the required inputs for a toolbar widget in a toolbar. */\nexport interface ToolbarWidgetInputs<V> extends Omit<\n  ListItem<V>,\n  'searchTerm' | 'index' | 'selectable'\n> {\n  /** A reference to the parent toolbar. */\n  toolbar: SignalLike<ToolbarPattern<V>>;\n\n  /** A reference to the parent widget group. */\n  group: SignalLike<ToolbarWidgetGroupPattern<ToolbarWidgetPattern<V>, V> | undefined>;\n}\n\nexport class ToolbarWidgetPattern<V> implements ListItem<V> {\n  /** A unique identifier for the widget. */\n  readonly id = () => this.inputs.id();\n\n  /** The html element that should receive focus. */\n  readonly element = () => this.inputs.element();\n\n  /** Whether the widget is disabled. */\n  readonly disabled = () => this.inputs.disabled() || this.group()?.disabled() || false;\n\n  /** A reference to the parent toolbar. */\n  readonly group = () => this.inputs.group();\n\n  /** A reference to the toolbar containing the widget. */\n  readonly toolbar = () => this.inputs.toolbar();\n\n  /** The tabindex of the widget. */\n  readonly tabIndex = computed(() => this.toolbar().listBehavior.getItemTabindex(this));\n\n  /** The text used by the typeahead search. */\n  readonly searchTerm = () => ''; // Unused because toolbar does not support typeahead.\n\n  /** The value associated with the widget. */\n  readonly value = () => this.inputs.value();\n\n  /** Whether the widget is selectable. */\n  readonly selectable = () => true; // Unused because toolbar does not support selection.\n\n  /** The position of the widget within the toolbar. */\n  readonly index = computed(() => this.toolbar().inputs.items().indexOf(this) ?? -1);\n\n  /** Whether the widget is selected (only relevant in a selection group). */\n  readonly selected = computed(() =>\n    this.toolbar().listBehavior.inputs.values().includes(this.value()),\n  );\n\n  /** Whether the widget is currently the active one (focused). */\n  readonly active: SignalLike<boolean> = computed(() => this.toolbar().activeItem() === this);\n\n  constructor(readonly inputs: ToolbarWidgetInputs<V>) {}\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {ListItem} from '../behaviors/list/list';\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport type {ToolbarPattern} from './toolbar';\n\n/** Represents the required inputs for a toolbar widget group. */\nexport interface ToolbarWidgetGroupInputs<T extends ListItem<V>, V> {\n  /** A reference to the parent toolbar. */\n  toolbar: SignalLike<ToolbarPattern<V> | undefined>;\n\n  /** Whether the widget group is disabled. */\n  disabled: SignalLike<boolean>;\n\n  /** The list of items within the widget group. */\n  items: SignalLike<T[]>;\n\n  /** Whether the group allows multiple widgets to be selected. */\n  multi: SignalLike<boolean>;\n}\n\n/** A group of widgets within a toolbar that provides nested navigation. */\nexport class ToolbarWidgetGroupPattern<T extends ListItem<V>, V> {\n  /** Whether the widget is disabled. */\n  readonly disabled = () => this.inputs.disabled();\n\n  /** A reference to the parent toolbar. */\n  readonly toolbar = () => this.inputs.toolbar();\n\n  /** Whether the group allows multiple widgets to be selected. */\n  readonly multi = () => this.inputs.multi();\n\n  readonly searchTerm = () => ''; // Unused because toolbar does not support typeahead.\n  readonly value = () => '' as V; // Unused because toolbar does not support selection.\n  readonly selectable = () => true; // Unused because toolbar does not support selection.\n  readonly element = () => undefined; // Unused because toolbar does not focus the group element.\n\n  constructor(readonly inputs: ToolbarWidgetGroupInputs<T, V>) {}\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed} from '@angular/core';\nimport {KeyboardEventManager, PointerEventManager} from '../behaviors/event-manager';\nimport {ExpansionItem, ListExpansion, ListExpansionInputs} from '../behaviors/expansion/expansion';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../behaviors/list-focus/list-focus';\nimport {\n  ListNavigation,\n  ListNavigationInputs,\n  ListNavigationItem,\n} from '../behaviors/list-navigation/list-navigation';\nimport {SignalLike, WritableSignalLike} from '../behaviors/signal-like/signal-like';\n\n/** Inputs of the AccordionGroupPattern. */\nexport interface AccordionGroupInputs extends Omit<\n  ListNavigationInputs<AccordionTriggerPattern> &\n    ListFocusInputs<AccordionTriggerPattern> &\n    Omit<ListExpansionInputs, 'items'>,\n  'focusMode'\n> {\n  /** A function that returns the trigger associated with a given element. */\n  getItem: (e: Element | null | undefined) => AccordionTriggerPattern | undefined;\n}\n\nconst focusMode = () => 'roving' as const;\n\n/** A pattern controls the nested Accordions. */\nexport class AccordionGroupPattern {\n  /** Controls navigation for the group. */\n  readonly navigationBehavior: ListNavigation<AccordionTriggerPattern>;\n\n  /** Controls focus for the group. */\n  readonly focusBehavior: ListFocus<AccordionTriggerPattern>;\n\n  /** Controls expansion for the group. */\n  readonly expansionBehavior: ListExpansion;\n\n  constructor(readonly inputs: AccordionGroupInputs) {\n    this.focusBehavior = new ListFocus({\n      ...inputs,\n      focusMode,\n    });\n    this.navigationBehavior = new ListNavigation({\n      ...inputs,\n      focusMode,\n      focusManager: this.focusBehavior,\n    });\n    this.expansionBehavior = new ListExpansion({\n      ...inputs,\n    });\n  }\n\n  /** The key used to navigate to the previous accordion trigger. */\n  prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key used to navigate to the next accordion trigger. */\n  nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The keydown event manager for the accordion trigger. */\n  keydown = computed(() => {\n    return new KeyboardEventManager()\n      .on(this.prevKey, () => this.navigationBehavior.prev())\n      .on(this.nextKey, () => this.navigationBehavior.next())\n      .on('Home', () => this.navigationBehavior.first())\n      .on('End', () => this.navigationBehavior.last())\n      .on(' ', () => this.toggle())\n      .on('Enter', () => this.toggle());\n  });\n\n  /** The pointerdown event manager for the accordion trigger. */\n  pointerdown = computed(() => {\n    return new PointerEventManager().on(e => {\n      const item = this.inputs.getItem(e.target as Element);\n      if (!item) return;\n\n      this.navigationBehavior.goto(item);\n      this.expansionBehavior.toggle(item);\n    });\n  });\n\n  /** Handles keydown events on the trigger, delegating to the group if not disabled. */\n  onKeydown(event: KeyboardEvent): void {\n    this.keydown().handle(event);\n  }\n\n  /** Handles pointerdown events on the trigger, delegating to the group if not disabled. */\n  onPointerdown(event: PointerEvent): void {\n    this.pointerdown().handle(event);\n  }\n\n  /** Handles focus events on the trigger. This ensures the tabbing changes the active index. */\n  onFocus(event: FocusEvent): void {\n    const item = this.inputs.getItem(event.target as Element);\n    if (!item) return;\n    if (!this.focusBehavior.isFocusable(item)) return;\n\n    this.focusBehavior.focus(item);\n  }\n\n  /** Toggles the expansion state of the active accordion item. */\n  toggle() {\n    const activeItem = this.inputs.activeItem();\n    if (activeItem === undefined) return;\n    this.expansionBehavior.toggle(activeItem);\n  }\n}\n\n/** Inputs for the AccordionTriggerPattern. */\nexport interface AccordionTriggerInputs\n  extends Omit<ListNavigationItem & ListFocusItem, 'index'>, Omit<ExpansionItem, 'expandable'> {\n  /** A local unique identifier for the trigger's corresponding panel. */\n  panelId: SignalLike<string>;\n\n  /** The parent accordion group that controls this trigger. */\n  accordionGroup: SignalLike<AccordionGroupPattern>;\n\n  /** The accordion panel controlled by this trigger. */\n  accordionPanel: SignalLike<AccordionPanelPattern | undefined>;\n}\n\n/** A pattern controls the expansion state of an accordion. */\nexport class AccordionTriggerPattern implements ListNavigationItem, ListFocusItem, ExpansionItem {\n  /** A unique identifier for this trigger. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** A reference to the trigger element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether this trigger has expandable panel. */\n  readonly expandable: SignalLike<boolean> = () => true;\n\n  /** Whether the corresponding panel is expanded. */\n  readonly expanded: WritableSignalLike<boolean>;\n\n  /** Whether the trigger is active. */\n  readonly active = computed(() => this.inputs.accordionGroup().inputs.activeItem() === this);\n\n  /** Id of the accordion panel controlled by the trigger. */\n  readonly controls = computed(() => this.inputs.accordionPanel()?.inputs.id());\n\n  /** The tabindex of the trigger. */\n  readonly tabIndex = computed(() =>\n    this.inputs.accordionGroup().focusBehavior.isFocusable(this) ? 0 : -1,\n  );\n\n  /** Whether the trigger is disabled. Disabling an accordion group disables all the triggers. */\n  readonly disabled = computed(\n    () => this.inputs.disabled() || this.inputs.accordionGroup().inputs.disabled(),\n  );\n\n  /** Whether the trigger is hard disabled.  */\n  readonly hardDisabled = computed(\n    () => this.disabled() && !this.inputs.accordionGroup().inputs.softDisabled(),\n  );\n\n  /** The index of the trigger within its accordion group. */\n  readonly index = computed(() => this.inputs.accordionGroup().inputs.items().indexOf(this));\n\n  constructor(readonly inputs: AccordionTriggerInputs) {\n    this.expanded = inputs.expanded;\n  }\n\n  /** Opens the accordion panel. */\n  open(): void {\n    this.inputs.accordionGroup().expansionBehavior.open(this);\n  }\n\n  /** Closes the accordion panel. */\n  close(): void {\n    this.inputs.accordionGroup().expansionBehavior.close(this);\n  }\n\n  /** Toggles the accordion panel. */\n  toggle(): void {\n    this.inputs.accordionGroup().expansionBehavior.toggle(this);\n  }\n}\n\n/** Represents the required inputs for the AccordionPanelPattern. */\nexport interface AccordionPanelInputs {\n  /** A global unique identifier for the panel. */\n  id: SignalLike<string>;\n\n  /** A local unique identifier for the panel, matching its trigger's panelId. */\n  panelId: SignalLike<string>;\n\n  /** The parent accordion trigger that controls this panel. */\n  accordionTrigger: SignalLike<AccordionTriggerPattern | undefined>;\n}\n\n/** Represents an accordion panel. */\nexport class AccordionPanelPattern {\n  /** A global unique identifier for the panel. */\n  id: SignalLike<string>;\n\n  /** The parent accordion trigger that controls this panel. */\n  accordionTrigger: SignalLike<AccordionTriggerPattern | undefined>;\n\n  /** Whether the accordion panel is hidden. True if the associated trigger is not expanded. */\n  hidden: SignalLike<boolean>;\n\n  constructor(readonly inputs: AccordionPanelInputs) {\n    this.id = inputs.id;\n    this.accordionTrigger = inputs.accordionTrigger;\n    this.hidden = computed(() => inputs.accordionTrigger()?.expanded() === false);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed} from '@angular/core';\nimport {SignalLike, WritableSignalLike} from '../behaviors/signal-like/signal-like';\nimport {List, ListInputs, ListItem} from '../behaviors/list/list';\nimport {ExpansionItem, ListExpansion} from '../behaviors/expansion/expansion';\nimport {KeyboardEventManager, PointerEventManager, Modifier} from '../behaviors/event-manager';\n\n/** Represents the required inputs for a tree item. */\nexport interface TreeItemInputs<V>\n  extends Omit<ListItem<V>, 'index'>, Omit<ExpansionItem, 'expandable'> {\n  /** The parent item. */\n  parent: SignalLike<TreeItemPattern<V> | TreePattern<V>>;\n\n  /** Whether this item has children. Children can be lazily loaded. */\n  hasChildren: SignalLike<boolean>;\n\n  /** The children items. */\n  children: SignalLike<TreeItemPattern<V>[]>;\n\n  /** The tree pattern this item belongs to. */\n  tree: SignalLike<TreePattern<V>>;\n}\n\n/**\n * Represents an item in a Tree.\n */\nexport class TreeItemPattern<V> implements ListItem<V>, ExpansionItem {\n  /** A unique identifier for this item. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The value of this item. */\n  readonly value: SignalLike<V> = () => this.inputs.value();\n\n  /** A reference to the item element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether the item is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The text used by the typeahead search. */\n  readonly searchTerm: SignalLike<string> = () => this.inputs.searchTerm();\n\n  /** The tree pattern this item belongs to. */\n  readonly tree: SignalLike<TreePattern<V>> = () => this.inputs.tree();\n\n  /** The parent item. */\n  readonly parent: SignalLike<TreeItemPattern<V> | TreePattern<V>> = () => this.inputs.parent();\n\n  /** The children items. */\n  readonly children: SignalLike<TreeItemPattern<V>[]> = () => this.inputs.children();\n\n  /** The position of this item among its siblings. */\n  readonly index = computed(() => this.tree().visibleItems().indexOf(this));\n\n  /** Controls expansion for child items. */\n  readonly expansionBehavior: ListExpansion;\n\n  /** Whether the item is expandable. It's expandable if children item exist. */\n  readonly expandable: SignalLike<boolean> = () => this.inputs.hasChildren();\n\n  /** Whether the item is selectable. */\n  readonly selectable: SignalLike<boolean> = () => this.inputs.selectable();\n\n  /** Whether the item is expanded. */\n  readonly expanded: WritableSignalLike<boolean>;\n\n  /** The level of the current item in a tree. */\n  readonly level: SignalLike<number> = computed(() => this.parent().level() + 1);\n\n  /** Whether this item is visible. */\n  readonly visible: SignalLike<boolean> = computed(\n    () => this.parent().expanded() && this.parent().visible(),\n  );\n\n  /** The number of items under the same parent at the same level. */\n  readonly setsize = computed(() => this.parent().children().length);\n\n  /** The position of this item among its siblings (1-based). */\n  readonly posinset = computed(() => this.parent().children().indexOf(this) + 1);\n\n  /** Whether the item is active. */\n  readonly active = computed(() => this.tree().activeItem() === this);\n\n  /** The tab index of the item. */\n  readonly tabIndex = computed(() => this.tree().listBehavior.getItemTabindex(this));\n\n  /** Whether the item is selected. */\n  readonly selected: SignalLike<boolean | undefined> = computed(() => {\n    if (this.tree().nav()) {\n      return undefined;\n    }\n    if (!this.selectable()) {\n      return undefined;\n    }\n    return this.tree().values().includes(this.value());\n  });\n\n  /** The current type of this item. */\n  readonly current: SignalLike<string | undefined> = computed(() => {\n    if (!this.tree().nav()) {\n      return undefined;\n    }\n    if (!this.selectable()) {\n      return undefined;\n    }\n    return this.tree().values().includes(this.value()) ? this.tree().currentType() : undefined;\n  });\n\n  constructor(readonly inputs: TreeItemInputs<V>) {\n    this.expanded = inputs.expanded;\n    this.expansionBehavior = new ListExpansion({\n      ...inputs,\n      multiExpandable: () => true,\n      items: this.children,\n      disabled: computed(() => this.tree()?.disabled() ?? false),\n    });\n  }\n}\n\n/** The selection operations that the tree can perform. */\ninterface SelectOptions {\n  toggle?: boolean;\n  selectOne?: boolean;\n  selectRange?: boolean;\n  anchor?: boolean;\n}\n\n/** Represents the required inputs for a tree. */\nexport interface TreeInputs<V> extends Omit<ListInputs<TreeItemPattern<V>, V>, 'items'> {\n  /** A unique identifier for the tree. */\n  id: SignalLike<string>;\n\n  /** All items in the tree, in document order (DFS-like, a flattened list). */\n  allItems: SignalLike<TreeItemPattern<V>[]>;\n\n  /** Whether the tree is in navigation mode. */\n  nav: SignalLike<boolean>;\n\n  /** The aria-current type. */\n  currentType: SignalLike<'page' | 'step' | 'location' | 'date' | 'time' | 'true' | 'false'>;\n}\n\n/** Controls the state and interactions of a tree view. */\nexport class TreePattern<V> implements TreeInputs<V> {\n  /** The list behavior for the tree. */\n  readonly listBehavior: List<TreeItemPattern<V>, V>;\n\n  /** Controls expansion for direct children of the tree root (top-level items). */\n  readonly expansionBehavior: ListExpansion;\n\n  /** The root level is 0. */\n  readonly level = () => 0;\n\n  /** The root is always expanded. */\n  readonly expanded = () => true;\n\n  /** The root is always visible. */\n  readonly visible = () => true;\n\n  /** The tab index of the tree. */\n  readonly tabIndex: SignalLike<-1 | 0> = computed(() => this.listBehavior.tabIndex());\n\n  /** The id of the current active item. */\n  readonly activeDescendant = computed(() => this.listBehavior.activeDescendant());\n\n  /** The direct children of the root (top-level tree items). */\n  readonly children = computed(() =>\n    this.inputs.allItems().filter(item => item.level() === this.level() + 1),\n  );\n\n  /** All currently visible tree items. An item is visible if their parent is expanded. */\n  readonly visibleItems = computed(() => this.inputs.allItems().filter(item => item.visible()));\n\n  /** Whether the tree selection follows focus. */\n  readonly followFocus = computed(() => this.inputs.selectionMode() === 'follow');\n\n  /** Whether the tree direction is RTL. */\n  readonly isRtl = computed(() => this.inputs.textDirection() === 'rtl');\n\n  /** The key for navigating to the previous item. */\n  readonly prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.isRtl() ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key for navigating to the next item. */\n  readonly nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.isRtl() ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The key for collapsing an item or moving to its parent. */\n  readonly collapseKey = computed(() => {\n    if (this.inputs.orientation() === 'horizontal') {\n      return 'ArrowUp';\n    }\n    return this.isRtl() ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key for expanding an item or moving to its first child. */\n  readonly expandKey = computed(() => {\n    if (this.inputs.orientation() === 'horizontal') {\n      return 'ArrowDown';\n    }\n    return this.isRtl() ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** Represents the space key. Does nothing when the user is actively using typeahead. */\n  readonly dynamicSpaceKey = computed(() => (this.listBehavior.isTyping() ? '' : ' '));\n\n  /** Regular expression to match characters for typeahead. */\n  readonly typeaheadRegexp = /^.$/;\n\n  /** The keydown event manager for the tree. */\n  readonly keydown = computed(() => {\n    const manager = new KeyboardEventManager();\n    const list = this.listBehavior;\n\n    manager\n      .on(this.prevKey, () => list.prev({selectOne: this.followFocus()}))\n      .on(this.nextKey, () => list.next({selectOne: this.followFocus()}))\n      .on('Home', () => list.first({selectOne: this.followFocus()}))\n      .on('End', () => list.last({selectOne: this.followFocus()}))\n      .on(this.typeaheadRegexp, e => list.search(e.key, {selectOne: this.followFocus()}))\n      .on(this.expandKey, () => this.expand({selectOne: this.followFocus()}))\n      .on(this.collapseKey, () => this.collapse({selectOne: this.followFocus()}))\n      .on(Modifier.Shift, '*', () => this.expandSiblings());\n\n    if (this.inputs.multi()) {\n      manager\n        // TODO: Tracking the anchor by index can break if the\n        // tree is expanded or collapsed causing the index to change.\n        .on(Modifier.Any, 'Shift', () => list.anchor(this.listBehavior.activeIndex()))\n        .on(Modifier.Shift, this.prevKey, () => list.prev({selectRange: true}))\n        .on(Modifier.Shift, this.nextKey, () => list.next({selectRange: true}))\n        .on([Modifier.Ctrl | Modifier.Shift, Modifier.Meta | Modifier.Shift], 'Home', () =>\n          list.first({selectRange: true, anchor: false}),\n        )\n        .on([Modifier.Ctrl | Modifier.Shift, Modifier.Meta | Modifier.Shift], 'End', () =>\n          list.last({selectRange: true, anchor: false}),\n        )\n        .on(Modifier.Shift, 'Enter', () => list.updateSelection({selectRange: true, anchor: false}))\n        .on(Modifier.Shift, this.dynamicSpaceKey, () =>\n          list.updateSelection({selectRange: true, anchor: false}),\n        );\n    }\n\n    if (!this.followFocus() && this.inputs.multi()) {\n      manager\n        .on(this.dynamicSpaceKey, () => list.toggle())\n        .on('Enter', () => list.toggle(), {preventDefault: !this.nav()})\n        .on([Modifier.Ctrl, Modifier.Meta], 'A', () => list.toggleAll());\n    }\n\n    if (!this.followFocus() && !this.inputs.multi()) {\n      manager.on(this.dynamicSpaceKey, () => list.selectOne());\n      manager.on('Enter', () => list.selectOne(), {preventDefault: !this.nav()});\n    }\n\n    if (this.inputs.multi() && this.followFocus()) {\n      manager\n        .on([Modifier.Ctrl, Modifier.Meta], this.prevKey, () => list.prev())\n        .on([Modifier.Ctrl, Modifier.Meta], this.nextKey, () => list.next())\n        .on([Modifier.Ctrl, Modifier.Meta], this.expandKey, () => this.expand())\n        .on([Modifier.Ctrl, Modifier.Meta], this.collapseKey, () => this.collapse())\n        .on([Modifier.Ctrl, Modifier.Meta], ' ', () => list.toggle())\n        .on([Modifier.Ctrl, Modifier.Meta], 'Enter', () => list.toggle())\n        .on([Modifier.Ctrl, Modifier.Meta], 'Home', () => list.first())\n        .on([Modifier.Ctrl, Modifier.Meta], 'End', () => list.last())\n        .on([Modifier.Ctrl, Modifier.Meta], 'A', () => {\n          list.toggleAll();\n          list.select(); // Ensure the currect item remains selected.\n        });\n    }\n\n    return manager;\n  });\n\n  /** The pointerdown event manager for the tree. */\n  pointerdown = computed(() => {\n    const manager = new PointerEventManager();\n\n    if (this.multi()) {\n      manager.on(Modifier.Shift, e => this.goto(e, {selectRange: true}));\n    }\n\n    if (!this.multi()) {\n      return manager.on(e => this.goto(e, {selectOne: true}));\n    }\n\n    if (this.multi() && this.followFocus()) {\n      return manager\n        .on(e => this.goto(e, {selectOne: true}))\n        .on(Modifier.Ctrl, e => this.goto(e, {toggle: true}));\n    }\n\n    if (this.multi() && !this.followFocus()) {\n      return manager.on(e => this.goto(e, {toggle: true}));\n    }\n\n    return manager;\n  });\n\n  /** A unique identifier for the tree. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** The host native element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether the tree is in navigation mode. */\n  readonly nav: SignalLike<boolean> = () => this.inputs.nav();\n\n  /** The aria-current type. */\n  readonly currentType: SignalLike<\n    'page' | 'step' | 'location' | 'date' | 'time' | 'true' | 'false'\n  > = () => this.inputs.currentType();\n\n  /** All items in the tree, in document order (DFS-like, a flattened list). */\n  readonly allItems: SignalLike<TreeItemPattern<V>[]> = () => this.inputs.allItems();\n\n  /** The focus strategy used by the tree. */\n  readonly focusMode: SignalLike<'roving' | 'activedescendant'> = () => this.inputs.focusMode();\n\n  /** Whether the tree is disabled. */\n  readonly disabled: SignalLike<boolean> = () => this.inputs.disabled();\n\n  /** The currently active item in the tree. */\n  readonly activeItem: WritableSignalLike<TreeItemPattern<V> | undefined>;\n\n  /** Whether disabled items should be focusable. */\n  readonly softDisabled: SignalLike<boolean> = () => this.inputs.softDisabled();\n\n  /** Whether the focus should wrap when navigating past the first or last item. */\n  readonly wrap: SignalLike<boolean> = () => this.inputs.wrap();\n\n  /** The orientation of the tree. */\n  readonly orientation: SignalLike<'vertical' | 'horizontal'> = () => this.inputs.orientation();\n\n  /** The text direction of the tree. */\n  readonly textDirection: SignalLike<'ltr' | 'rtl'> = () => this.textDirection();\n\n  /** Whether multiple items can be selected at the same time. */\n  readonly multi: SignalLike<boolean> = computed(() => (this.nav() ? false : this.inputs.multi()));\n\n  /** The selection mode of the tree. */\n  readonly selectionMode: SignalLike<'follow' | 'explicit'> = () => this.inputs.selectionMode();\n\n  /** The delay in milliseconds to wait before clearing the typeahead buffer. */\n  readonly typeaheadDelay: SignalLike<number> = () => this.inputs.typeaheadDelay();\n\n  /** The current selected items of the tree. */\n  readonly values: WritableSignalLike<V[]>;\n\n  constructor(readonly inputs: TreeInputs<V>) {\n    this.activeItem = inputs.activeItem;\n    this.values = inputs.values;\n\n    this.listBehavior = new List({\n      ...inputs,\n      items: this.visibleItems,\n      multi: this.multi,\n    });\n\n    this.expansionBehavior = new ListExpansion({\n      multiExpandable: () => true,\n      items: this.children,\n      disabled: this.disabled,\n    });\n  }\n\n  /**\n   * Sets the tree to it's default initial state.\n   *\n   * Sets the active index of the tree to the first focusable selected tree item if one exists.\n   * Otherwise, sets focus to the first focusable tree item.\n   */\n  setDefaultState() {\n    let firstItem: TreeItemPattern<V> | undefined;\n\n    for (const item of this.allItems()) {\n      if (!item.visible()) continue;\n      if (!this.listBehavior.isFocusable(item)) continue;\n\n      if (firstItem === undefined) {\n        firstItem = item;\n      }\n\n      if (item.selected()) {\n        this.activeItem.set(item);\n        return;\n      }\n    }\n\n    if (firstItem !== undefined) {\n      this.activeItem.set(firstItem);\n    }\n  }\n\n  /** Handles keydown events on the tree. */\n  onKeydown(event: KeyboardEvent) {\n    if (!this.disabled()) {\n      this.keydown().handle(event);\n    }\n  }\n\n  /** Handles pointerdown events on the tree. */\n  onPointerdown(event: PointerEvent) {\n    if (!this.disabled()) {\n      this.pointerdown().handle(event);\n    }\n  }\n\n  /** Navigates to the given tree item in the tree. */\n  goto(e: PointerEvent, opts?: SelectOptions) {\n    const item = this._getItem(e);\n    if (!item) return;\n\n    this.listBehavior.goto(item, opts);\n    this.toggleExpansion(item);\n  }\n\n  /** Toggles to expand or collapse a tree item. */\n  toggleExpansion(item?: TreeItemPattern<V>) {\n    item ??= this.activeItem();\n    if (!item || !this.listBehavior.isFocusable(item)) return;\n\n    if (!item.expandable()) return;\n    if (item.expanded()) {\n      this.collapse();\n    } else {\n      this.expansionBehavior.open(item);\n    }\n  }\n\n  /** Expands a tree item. */\n  expand(opts?: SelectOptions) {\n    const item = this.activeItem();\n    if (!item || !this.listBehavior.isFocusable(item)) return;\n\n    if (item.expandable() && !item.expanded()) {\n      this.expansionBehavior.open(item);\n    } else if (\n      item.expanded() &&\n      item.children().some(item => this.listBehavior.isFocusable(item))\n    ) {\n      this.listBehavior.next(opts);\n    }\n  }\n\n  /** Expands all sibling tree items including itself. */\n  expandSiblings(item?: TreeItemPattern<V>) {\n    item ??= this.activeItem();\n    const siblings = item?.parent()?.children();\n    siblings?.forEach(item => this.expansionBehavior.open(item));\n  }\n\n  /** Collapses a tree item. */\n  collapse(opts?: SelectOptions) {\n    const item = this.activeItem();\n    if (!item || !this.listBehavior.isFocusable(item)) return;\n\n    if (item.expandable() && item.expanded()) {\n      this.expansionBehavior.close(item);\n    } else if (item.parent() && item.parent() !== this) {\n      const parentItem = item.parent();\n      if (parentItem instanceof TreeItemPattern && this.listBehavior.isFocusable(parentItem)) {\n        this.listBehavior.goto(parentItem, opts);\n      }\n    }\n  }\n\n  /** Retrieves the TreeItemPattern associated with a DOM event, if any. */\n  protected _getItem(event: Event): TreeItemPattern<V> | undefined {\n    if (!(event.target instanceof HTMLElement)) {\n      return;\n    }\n    const element = event.target.closest('[role=\"treeitem\"]');\n    return this.inputs.allItems().find(i => i.element() === element);\n  }\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {computed} from '@angular/core';\nimport {TreeInputs, TreePattern, TreeItemPattern} from './tree';\nimport {SignalLike} from '../behaviors/signal-like/signal-like';\nimport {ComboboxPattern, ComboboxTreeControls} from '../combobox/combobox';\n\nexport type ComboboxTreeInputs<V> = TreeInputs<V> & {\n  /** The combobox controlling the tree. */\n  combobox: SignalLike<ComboboxPattern<TreeItemPattern<V>, V> | undefined>;\n};\n\nexport class ComboboxTreePattern<V>\n  extends TreePattern<V>\n  implements ComboboxTreeControls<TreeItemPattern<V>, V>\n{\n  /** Whether the currently focused item is collapsible. */\n  isItemCollapsible = () => this.inputs.activeItem()?.parent() instanceof TreeItemPattern;\n\n  /** The ARIA role for the tree. */\n  role = () => 'tree' as const;\n\n  /* The id of the active (focused) item in the tree. */\n  activeId = computed(() => this.listBehavior.activeDescendant());\n\n  /** Returns the currently active (focused) item in the tree. */\n  getActiveItem = () => this.inputs.activeItem();\n\n  /** The list of items in the tree. */\n  items = computed(() => this.inputs.allItems());\n\n  /** The tab index for the tree. Always -1 because the combobox handles focus. */\n  override tabIndex: SignalLike<-1 | 0> = () => -1;\n\n  constructor(override readonly inputs: ComboboxTreeInputs<V>) {\n    if (inputs.combobox()) {\n      inputs.multi = () => false;\n      inputs.focusMode = () => 'activedescendant';\n      inputs.element = inputs.combobox()!.inputs.inputEl;\n    }\n\n    super(inputs);\n  }\n\n  /** Noop. The combobox handles keydown events. */\n  override onKeydown(_: KeyboardEvent): void {}\n\n  /** Noop. The combobox handles pointerdown events. */\n  override onPointerdown(_: PointerEvent): void {}\n\n  /** Noop. The combobox controls the open state. */\n  override setDefaultState(): void {}\n\n  /** Navigates to the specified item in the tree. */\n  focus = (item: TreeItemPattern<V>) => this.listBehavior.goto(item);\n\n  /** Navigates to the next focusable item in the tree. */\n  next = () => this.listBehavior.next();\n\n  /** Navigates to the previous focusable item in the tree. */\n  prev = () => this.listBehavior.prev();\n\n  /** Navigates to the last focusable item in the tree. */\n  last = () => this.listBehavior.last();\n\n  /** Navigates to the first focusable item in the tree. */\n  first = () => this.listBehavior.first();\n\n  /** Unfocuses the currently focused item in the tree. */\n  unfocus = () => this.listBehavior.unfocus();\n\n  // TODO: handle non-selectable parent nodes.\n  /** Selects the specified item in the tree or the current active item if not provided. */\n  select = (item?: TreeItemPattern<V>) => this.listBehavior.select(item);\n\n  /** Toggles the selection state of the given item in the tree or the current active item if not provided. */\n  toggle = (item?: TreeItemPattern<V>) => this.listBehavior.toggle(item);\n\n  /** Clears the selection in the tree. */\n  clearSelection = () => this.listBehavior.deselectAll();\n\n  /** Retrieves the TreeItemPattern associated with a pointer event. */\n  getItem = (e: PointerEvent) => this._getItem(e);\n\n  /** Retrieves the currently selected items in the tree */\n  getSelectedItems = () => this.inputs.allItems().filter(item => item.selected());\n\n  /** Sets the value of the combobox tree. */\n  setValue = (value: V | undefined) => this.inputs.values.set(value ? [value] : []);\n\n  /** Expands the currently focused item if it is expandable. */\n  expandItem = () => this.expand();\n\n  /** Collapses the currently focused item if it is expandable. */\n  collapseItem = () => this.collapse();\n\n  /** Whether the specified item or the currently active item is expandable. */\n  isItemExpandable(item: TreeItemPattern<V> | undefined = this.inputs.activeItem()) {\n    return item ? item.expandable() : false;\n  }\n\n  /** Expands all of the tree items. */\n  expandAll = () => this.items().forEach(item => this.expansionBehavior.open(item));\n\n  /** Collapses all of the tree items. */\n  collapseAll = () => this.items().forEach(item => item.expansionBehavior.close(item));\n\n  /** Whether the currently active item is selectable. */\n  isItemSelectable = (item: TreeItemPattern<V> | undefined = this.inputs.activeItem()) => {\n    return item ? item.selectable() : false;\n  };\n}\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  afterRenderEffect,\n  Directive,\n  inject,\n  TemplateRef,\n  signal,\n  ViewContainerRef,\n  model,\n  EmbeddedViewRef,\n  OnDestroy,\n} from '@angular/core';\n\n/**\n * A container directive controls the visibility of its content.\n */\n@Directive()\nexport class DeferredContentAware {\n  readonly contentVisible = signal(false);\n  readonly preserveContent = model(false);\n}\n\n/**\n * DeferredContent loads/unloads the content based on the visibility.\n * The visibilty signal is sent from a parent directive implements\n * DeferredContentAware.\n *\n * Use this directive as a host directive. For example:\n *\n * ```ts\n *   @Directive({\n *     selector: 'ng-template[AccordionContent]',\n *     hostDirectives: [DeferredContent],\n *   })\n *   class AccordionContent {}\n * ```\n */\n@Directive()\nexport class DeferredContent implements OnDestroy {\n  private readonly _deferredContentAware = inject(DeferredContentAware, {optional: true});\n  private readonly _templateRef = inject(TemplateRef);\n  private readonly _viewContainerRef = inject(ViewContainerRef);\n  private _currentViewRef: EmbeddedViewRef<unknown> | null = null;\n  private _isRendered = false;\n\n  readonly deferredContentAware = signal(this._deferredContentAware);\n\n  constructor() {\n    afterRenderEffect(() => {\n      if (this.deferredContentAware()?.contentVisible()) {\n        if (!this._isRendered) {\n          this._destroyContent();\n          this._currentViewRef = this._viewContainerRef.createEmbeddedView(this._templateRef);\n          this._isRendered = true;\n        }\n      } else if (!this.deferredContentAware()?.preserveContent()) {\n        this._destroyContent();\n        this._isRendered = false;\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    this._destroyContent();\n  }\n\n  private _destroyContent() {\n    const ref = this._currentViewRef;\n\n    if (ref && !ref.destroyed) {\n      ref.destroy();\n      this._currentViewRef = null;\n    }\n  }\n}\n"],"names":["ComboboxPattern","inputs","expanded","signal","disabled","activeDescendant","computed","popupControls","ComboboxDialogPattern","activeId","highlightedItem","undefined","isDeleting","isFocused","hasBeenFocused","expandKey","textDirection","collapseKey","popupId","id","autocomplete","filterMode","hasPopup","role","readonly","listControls","treeControls","keydown","manager","KeyboardEventManager","on","open","alwaysExpanded","close","reset","first","last","selected","next","prev","select","commit","multi","isItemSelectable","isItemExpandable","expandItem","collapseItem","isItemCollapsible","click","PointerEventManager","e","target","inputEl","controls","item","getItem","toggleExpansion","focus","constructor","onKeydown","event","handle","onClick","onInput","inputValue","set","value","InputEvent","inputType","match","highlight","onFocusIn","firstSelectedItem","getSelectedItems","onFocusOut","relatedTarget","HTMLElement","containerEl","contains","items","find","i","searchTerm","firstMatch","onFilter","isInitialRender","length","expandAll","collapseAll","clearSelection","unfocus","selectedItems","isHighlightable","toLowerCase","startsWith","slice","setSelectionRange","opts","some","selectedItem","nav","isHighlighting","selectionStart","includes","_navigate","getActiveItem","focusElement","toggle","map","join","operation","combobox","element","MenuPattern","visible","parent","listBehavior","hasBeenHovered","_openTimeout","_closeTimeout","tabIndex","shouldFocus","root","MenuTriggerPattern","MenuBarPattern","_expandKey","_collapseKey","dynamicSpaceKey","isTyping","typeaheadRegexp","grandparent","keydownManager","trigger","closeAll","expand","collapse","search","key","List","values","setDefaultState","goto","onMouseOver","activeItem","MenuItemPattern","_clearTimeouts","_closeItem","_clearCloseTimeout","_openItem","_clearOpenTimeout","setTimeout","expansionDelay","onMouseOut","submit","parentEl","refocus","siblings","filter","isMenu","isMenuBar","isMenuTrigger","submenu","onSelect","clearTimeout","_nextKey","_previousKey","prevItem","menu","menuitems","menuitem","pop","_expanded","concat","active","getItemTabindex","index","indexOf","selectable","convertGetterSetterToWritableSignalLike","getter","setter","Object","assign","update","updateCallback","ListExpansion","isExpandable","multiExpandable","openAll","expandable","LabelControl","label","labelledBy","defaultLabelledBy","TabPattern","tablist","selectedTab","focusBehavior","getItemTabIndex","tabpanel","TabPanelPattern","labelManager","hidden","tab","TabListPattern","navigationBehavior","expansionBehavior","activeTab","orientation","getListTabIndex","getActiveDescendant","followFocus","selectionMode","prevKey","nextKey","pointerdown","_getItem","ListFocus","ListNavigation","focusManager","firstItem","isFocusable","onPointerdown","t","success","op","shouldExpand","closest","ToolbarPattern","softDisabled","_prevKey","_altPrevKey","_altNextKey","_keydown","_groupNext","_groupPrev","currGroup","group","nextGroup","peekNext","peekFirst","peekPrev","peekLast","_goto","forEach","deselect","focusMode","typeaheadDelay","preventDefault","validate","violations","ToolbarWidgetPattern","toolbar","ToolbarWidgetGroupPattern","AccordionGroupPattern","onFocus","AccordionTriggerPattern","accordionGroup","accordionPanel","hardDisabled","AccordionPanelPattern","accordionTrigger","TreeItemPattern","tree","children","visibleItems","hasChildren","level","setsize","posinset","current","currentType","TreePattern","allItems","isRtl","list","selectOne","Modifier","Shift","expandSiblings","Any","anchor","activeIndex","selectRange","Ctrl","Meta","updateSelection","toggleAll","wrap","parentItem","ComboboxTreePattern","_","deselectAll","setValue","DeferredContentAware","contentVisible","preserveContent","model","deps","i0","FactoryTarget","Directive","isStandalone","classPropertyName","publicName","isSignal","isRequired","transformFunction","outputs","ngImport","decorators","DeferredContent","_deferredContentAware","inject","optional","_templateRef","TemplateRef","_viewContainerRef","ViewContainerRef","_currentViewRef","_isRendered","deferredContentAware","afterRenderEffect","_destroyContent","createEmbeddedView","ngOnDestroy","ref","destroyed","destroy"],"mappings":"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"}