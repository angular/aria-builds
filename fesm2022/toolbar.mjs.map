{"version":3,"file":"toolbar.mjs","sources":["../../../../../k8-fastbuild-ST-199a4f3c4e20/bin/src/aria/toolbar/toolbar.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  afterRenderEffect,\n  Directive,\n  ElementRef,\n  inject,\n  computed,\n  input,\n  booleanAttribute,\n  signal,\n  Signal,\n  OnInit,\n  OnDestroy,\n  contentChildren,\n} from '@angular/core';\nimport {\n  ToolbarPattern,\n  ToolbarWidgetPattern,\n  ToolbarWidgetGroupPattern,\n  SignalLike,\n} from '@angular/aria/private';\nimport {Directionality} from '@angular/cdk/bidi';\nimport {_IdGenerator} from '@angular/cdk/a11y';\n\ninterface HasElement {\n  element: Signal<HTMLElement>;\n}\n\n/**\n * Sort directives by their document order.\n */\nfunction sortDirectives(a: HasElement, b: HasElement) {\n  return (a.element().compareDocumentPosition(b.element()) & Node.DOCUMENT_POSITION_PRECEDING) > 0\n    ? 1\n    : -1;\n}\n\n/**\n * A toolbar widget container.\n *\n * Widgets such as radio groups or buttons are nested within a toolbar to allow for a single\n * place of reference for focus and navigation. The Toolbar is meant to be used in conjunction\n * with ToolbarWidget and RadioGroup as follows:\n *\n * ```html\n * <div ngToolbar>\n *  <button ngToolbarWidget>Button</button>\n *  <div ngRadioGroup>\n *    <label ngRadioButton value=\"1\">Option 1</label>\n *    <label ngRadioButton value=\"2\">Option 2</label>\n *    <label ngRadioButton value=\"3\">Option 3</label>\n *  </div>\n * </div>\n * ```\n */\n@Directive({\n  selector: '[ngToolbar]',\n  exportAs: 'ngToolbar',\n  host: {\n    'role': 'toolbar',\n    'class': 'ng-toolbar',\n    '[attr.tabindex]': '_pattern.tabIndex()',\n    '[attr.aria-disabled]': '_pattern.disabled()',\n    '[attr.aria-orientation]': '_pattern.orientation()',\n    '(keydown)': '_pattern.onKeydown($event)',\n    '(click)': '_pattern.onClick($event)',\n    '(pointerdown)': '_pattern.onPointerdown($event)',\n    '(focusin)': 'onFocus()',\n  },\n})\nexport class Toolbar<V> {\n  /** A reference to the toolbar element. */\n  private readonly _elementRef = inject(ElementRef);\n\n  /** The TabList nested inside of the container. */\n  private readonly _widgets = signal(new Set<ToolbarWidget<V>>());\n\n  /** Text direction. */\n  readonly textDirection = inject(Directionality).valueSignal;\n\n  /** Sorted UIPatterns of the child widgets */\n  readonly items = computed(() =>\n    [...this._widgets()].sort(sortDirectives).map(widget => widget._pattern),\n  );\n\n  /** Whether the toolbar is vertically or horizontally oriented. */\n  readonly orientation = input<'vertical' | 'horizontal'>('horizontal');\n\n  /** Whether to allow disabled items to receive focus. */\n  softDisabled = input(true, {transform: booleanAttribute});\n\n  /** Whether the toolbar is disabled. */\n  readonly disabled = input(false, {transform: booleanAttribute});\n\n  /** Whether focus should wrap when navigating. */\n  readonly wrap = input(true, {transform: booleanAttribute});\n\n  /** The toolbar UIPattern. */\n  readonly _pattern: ToolbarPattern<V> = new ToolbarPattern<V>({\n    ...this,\n    activeItem: signal(undefined),\n    textDirection: this.textDirection,\n    element: () => this._elementRef.nativeElement,\n    getItem: e => this._getItem(e),\n  });\n\n  /** Whether the toolbar has received focus yet. */\n  private _hasBeenFocused = signal(false);\n\n  constructor() {\n    afterRenderEffect(() => {\n      if (typeof ngDevMode === 'undefined' || ngDevMode) {\n        const violations = this._pattern.validate();\n        for (const violation of violations) {\n          console.error(violation);\n        }\n      }\n    });\n\n    afterRenderEffect(() => {\n      if (!this._hasBeenFocused()) {\n        this._pattern.setDefaultState();\n      }\n    });\n  }\n\n  onFocus() {\n    this._hasBeenFocused.set(true);\n  }\n\n  register(widget: ToolbarWidget<V>) {\n    const widgets = this._widgets();\n    if (!widgets.has(widget)) {\n      widgets.add(widget);\n      this._widgets.set(new Set(widgets));\n    }\n  }\n\n  unregister(widget: ToolbarWidget<V>) {\n    const widgets = this._widgets();\n    if (widgets.delete(widget)) {\n      this._widgets.set(new Set(widgets));\n    }\n  }\n\n  /** Finds the toolbar item associated with a given element. */\n  private _getItem(element: Element) {\n    const widgetTarget = element.closest('.ng-toolbar-widget');\n    return this.items().find(widget => widget.element() === widgetTarget);\n  }\n}\n\n/**\n * A widget within a toolbar.\n *\n * A widget is anything that is within a toolbar. It should be applied to any native HTML element\n * that has the purpose of acting as a widget navigatable within a toolbar.\n */\n@Directive({\n  selector: '[ngToolbarWidget]',\n  exportAs: 'ngToolbarWidget',\n  host: {\n    'class': 'ng-toolbar-widget',\n    '[attr.data-active]': '_pattern.active()',\n    '[attr.tabindex]': '_pattern.tabIndex()',\n    '[attr.inert]': 'hardDisabled() ? true : null',\n    '[attr.disabled]': 'hardDisabled() ? true : null',\n    '[attr.aria-disabled]': '_pattern.disabled()',\n    '[id]': '_pattern.id()',\n  },\n})\nexport class ToolbarWidget<V> implements OnInit, OnDestroy {\n  /** A reference to the widget element. */\n  private readonly _elementRef = inject(ElementRef);\n\n  /** The parent Toolbar. */\n  private readonly _toolbar = inject(Toolbar);\n\n  /** A unique identifier for the widget. */\n  private readonly _generatedId = inject(_IdGenerator).getId('ng-toolbar-widget-', true);\n\n  /** A unique identifier for the widget. */\n  readonly id = input<string>(this._generatedId);\n\n  /** The parent Toolbar UIPattern. */\n  readonly toolbar = computed(() => this._toolbar._pattern);\n\n  /** A reference to the widget element to be focused on navigation. */\n  readonly element = computed(() => this._elementRef.nativeElement);\n\n  /** Whether the widget is disabled. */\n  readonly disabled = input(false, {transform: booleanAttribute});\n\n  /** Whether the widget is 'hard' disabled, which is different from `aria-disabled`. A hard disabled widget cannot receive focus. */\n  readonly hardDisabled = computed(() => this._pattern.disabled() && !this._toolbar.softDisabled());\n\n  /** The optional ToolbarWidgetGroup this widget belongs to. */\n  readonly _group = inject(ToolbarWidgetGroup, {optional: true});\n\n  /** The value associated with the widget. */\n  readonly value = input.required<V>();\n\n  /** Whether the widget is currently active (focused). */\n  readonly active = computed(() => this._pattern.active());\n\n  /** Whether the widget is selected (only relevant in a selection group). */\n  readonly selected = () => this._pattern.selected();\n\n  readonly group: SignalLike<ToolbarWidgetGroupPattern<ToolbarWidgetPattern<V>, V> | undefined> =\n    () => this._group?._pattern;\n\n  /** The ToolbarWidget UIPattern. */\n  readonly _pattern = new ToolbarWidgetPattern<V>({\n    ...this,\n    id: this.id,\n    value: this.value,\n    element: this.element,\n  });\n\n  ngOnInit() {\n    this._toolbar.register(this);\n  }\n\n  ngOnDestroy() {\n    this._toolbar.unregister(this);\n  }\n}\n\n/**\n * A directive that groups toolbar widgets, used for more complex widgets like radio groups that\n * have their own internal navigation.\n */\n@Directive({\n  selector: '[ngToolbarWidgetGroup]',\n  exportAs: 'ngToolbarWidgetGroup',\n  host: {\n    '[class.ng-toolbar-widget-group]': '!!toolbar()',\n  },\n})\nexport class ToolbarWidgetGroup<V> {\n  /** The parent Toolbar. */\n  private readonly _toolbar = inject(Toolbar, {optional: true});\n\n  /** The list of child widgets within the group. */\n  private readonly _widgets = contentChildren(ToolbarWidget<V>, {descendants: true});\n\n  /** The parent Toolbar UIPattern. */\n  readonly toolbar = computed(() => this._toolbar?._pattern);\n\n  /** Whether the widget group is disabled. */\n  readonly disabled = input(false, {transform: booleanAttribute});\n\n  /** The list of toolbar items within the group. */\n  readonly items = () => this._widgets().map(w => w._pattern);\n\n  /** Whether the group allows multiple widgets to be selected. */\n  readonly multi = input(false, {transform: booleanAttribute});\n\n  /** The ToolbarWidgetGroup UIPattern. */\n  readonly _pattern = new ToolbarWidgetGroupPattern<ToolbarWidgetPattern<V>, V>(this);\n}\n"],"names":["sort","sortDirectives","map","widget","_pattern","ngDevMode","debugName","softDisabled","input","transform","booleanAttribute","wrap","textDirection","element","_elementRef","nativeElement","getItem","e","_getItem","signal","constructor","afterRenderEffect","violations","validate","violation","console","error","setDefaultState","onFocus","_hasBeenFocused","set","widgets","has","add","_widgets","Set","unregister","delete","widgetTarget","closest","items","find","ɵfac","i0","ɵɵngDeclareFactory","minVersion","version","ngImport","type","Toolbar","deps","target","ɵɵFactoryTarget","Directive","decorators","args","id","_generatedId","toolbar","computed","_toolbar","hardDisabled","value","required","selected","group","_group","ToolbarWidgetPattern"],"mappings":"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"}