{"version":3,"file":"radio-group.mjs","sources":["../../../../../k8-fastbuild-ST-199a4f3c4e20/bin/src/aria/radio-group/radio-group.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  afterRenderEffect,\n  booleanAttribute,\n  computed,\n  contentChildren,\n  Directive,\n  ElementRef,\n  inject,\n  input,\n  linkedSignal,\n  model,\n  signal,\n  WritableSignal,\n} from '@angular/core';\nimport {\n  RadioButtonPattern,\n  RadioGroupInputs,\n  RadioGroupPattern,\n  ToolbarRadioGroupInputs,\n  ToolbarRadioGroupPattern,\n} from '@angular/aria/private';\nimport {Directionality} from '@angular/cdk/bidi';\nimport {_IdGenerator} from '@angular/cdk/a11y';\nimport {ToolbarWidgetGroup} from '@angular/aria/toolbar';\n\n// TODO: Move mapSignal to it's own file so it can be reused across components.\n\n/**\n * Creates a new writable signal (signal V) whose value is connected to the given original\n * writable signal (signal T) such that updating signal V updates signal T and vice-versa.\n *\n * This function establishes a two-way synchronization between the source signal and the new mapped\n * signal. When the source signal changes, the mapped signal updates by applying the `transform`\n * function. When the mapped signal is explicitly set or updated, the change is propagated back to\n * the source signal by applying the `reverse` function.\n */\nexport function mapSignal<T, V>(\n  originalSignal: WritableSignal<T>,\n  operations: {\n    transform: (value: T) => V;\n    reverse: (value: V) => T;\n  },\n) {\n  const mappedSignal = linkedSignal(() => operations.transform(originalSignal()));\n  const updateMappedSignal = mappedSignal.update;\n  const setMappedSignal = mappedSignal.set;\n\n  mappedSignal.set = (newValue: V) => {\n    setMappedSignal(newValue);\n    originalSignal.set(operations.reverse(newValue));\n  };\n\n  mappedSignal.update = (updateFn: (value: V) => V) => {\n    updateMappedSignal(oldValue => updateFn(oldValue));\n    originalSignal.update(oldValue => operations.reverse(updateFn(operations.transform(oldValue))));\n  };\n\n  return mappedSignal;\n}\n\n/**\n * A radio button group container.\n *\n * Radio groups are used to group multiple radio buttons or radio group labels so they function as\n * a single form control. The RadioGroup is meant to be used in conjunction with RadioButton\n * as follows:\n *\n * ```html\n * <div ngRadioGroup>\n *   <div ngRadioButton value=\"1\">Option 1</div>\n *   <div ngRadioButton value=\"2\">Option 2</div>\n *   <div ngRadioButton value=\"3\">Option 3</div>\n * </div>\n * ```\n */\n@Directive({\n  selector: '[ngRadioGroup]',\n  exportAs: 'ngRadioGroup',\n  host: {\n    'role': 'radiogroup',\n    'class': 'ng-radio-group',\n    '[attr.tabindex]': '_pattern.tabindex()',\n    '[attr.aria-readonly]': '_pattern.readonly()',\n    '[attr.aria-disabled]': '_pattern.disabled()',\n    '[attr.aria-orientation]': '_pattern.orientation()',\n    '[attr.aria-activedescendant]': '_pattern.activedescendant()',\n    '(keydown)': '_pattern.onKeydown($event)',\n    '(pointerdown)': '_pattern.onPointerdown($event)',\n    '(focusin)': 'onFocus()',\n  },\n  hostDirectives: [\n    {\n      directive: ToolbarWidgetGroup,\n      inputs: ['disabled'],\n    },\n  ],\n})\nexport class RadioGroup<V> {\n  /** A reference to the radio group element. */\n  private readonly _elementRef = inject(ElementRef);\n\n  /** A reference to the ToolbarWidgetGroup, if the radio group is in a toolbar. */\n  private readonly _toolbarWidgetGroup = inject(ToolbarWidgetGroup);\n\n  /** Whether the radio group is inside of a Toolbar. */\n  private readonly _hasToolbar = computed(() => !!this._toolbarWidgetGroup.toolbar());\n\n  /** The RadioButtons nested inside of the RadioGroup. */\n  private readonly _radioButtons = contentChildren(RadioButton, {descendants: true});\n\n  /** A signal wrapper for directionality. */\n  protected textDirection = inject(Directionality).valueSignal;\n\n  /** The RadioButton UIPatterns of the child RadioButtons. */\n  protected items = computed(() => this._radioButtons().map(radio => radio._pattern));\n\n  /** Whether the radio group is vertically or horizontally oriented. */\n  readonly orientation = input<'vertical' | 'horizontal'>('vertical');\n\n  /** Whether disabled items in the group should be skipped when navigating. */\n  readonly skipDisabled = input(true, {transform: booleanAttribute});\n\n  /** The focus strategy used by the radio group. */\n  readonly focusMode = input<'roving' | 'activedescendant'>('roving');\n\n  /** Whether the radio group is disabled. */\n  readonly disabled = input(false, {transform: booleanAttribute});\n\n  /** Whether the radio group is readonly. */\n  readonly readonly = input(false, {transform: booleanAttribute});\n\n  /** The value of the currently selected radio button. */\n  readonly value = model<V | null>(null);\n\n  /** The internal selection state for the radio group. */\n  private readonly _value = mapSignal<V | null, V[]>(this.value, {\n    transform: value => (value !== null ? [value] : []),\n    reverse: values => (values.length === 0 ? null : values[0]),\n  });\n\n  /** The RadioGroup UIPattern. */\n  readonly _pattern: RadioGroupPattern<V>;\n\n  /** Whether the radio group has received focus yet. */\n  private _hasFocused = signal(false);\n\n  constructor() {\n    const inputs: RadioGroupInputs<V> | ToolbarRadioGroupInputs<V> = {\n      ...this,\n      items: this.items,\n      value: this._value,\n      activeItem: signal(undefined),\n      textDirection: this.textDirection,\n      element: () => this._elementRef.nativeElement,\n      getItem: e => {\n        if (!(e.target instanceof HTMLElement)) {\n          return undefined;\n        }\n        const element = e.target.closest('[role=\"radio\"]');\n        return this.items().find(i => i.element() === element);\n      },\n      toolbar: this._toolbarWidgetGroup.toolbar,\n    };\n\n    this._pattern = this._hasToolbar()\n      ? new ToolbarRadioGroupPattern<V>(inputs as ToolbarRadioGroupInputs<V>)\n      : new RadioGroupPattern<V>(inputs as RadioGroupInputs<V>);\n\n    if (this._hasToolbar()) {\n      this._toolbarWidgetGroup.controls.set(this._pattern as ToolbarRadioGroupPattern<V>);\n    }\n\n    afterRenderEffect(() => {\n      if (typeof ngDevMode === 'undefined' || ngDevMode) {\n        const violations = this._pattern.validate();\n        for (const violation of violations) {\n          console.error(violation);\n        }\n      }\n    });\n\n    afterRenderEffect(() => {\n      if (!this._hasFocused() && !this._hasToolbar()) {\n        this._pattern.setDefaultState();\n      }\n    });\n  }\n\n  onFocus() {\n    this._hasFocused.set(true);\n  }\n}\n\n/** A selectable radio button in a RadioGroup. */\n@Directive({\n  selector: '[ngRadioButton]',\n  exportAs: 'ngRadioButton',\n  host: {\n    'role': 'radio',\n    'class': 'ng-radio-button',\n    '[attr.data-active]': '_pattern.active()',\n    '[attr.tabindex]': '_pattern.tabindex()',\n    '[attr.aria-checked]': '_pattern.selected()',\n    '[attr.aria-disabled]': '_pattern.disabled()',\n    '[id]': '_pattern.id()',\n  },\n})\nexport class RadioButton<V> {\n  /** A reference to the radio button element. */\n  private readonly _elementRef = inject(ElementRef);\n\n  /** The parent RadioGroup. */\n  private readonly _radioGroup = inject(RadioGroup);\n\n  /** A unique identifier for the radio button. */\n  private readonly _generatedId = inject(_IdGenerator).getId('ng-radio-button-', true);\n\n  /** A unique identifier for the radio button. */\n  readonly id = computed(() => this._generatedId);\n\n  /** The value associated with the radio button. */\n  readonly value = input.required<V>();\n\n  /** The parent RadioGroup UIPattern. */\n  readonly group = computed(() => this._radioGroup._pattern);\n\n  /** A reference to the radio button element to be focused on navigation. */\n  element = computed(() => this._elementRef.nativeElement);\n\n  /** Whether the radio button is disabled. */\n  disabled = input(false, {transform: booleanAttribute});\n\n  /** Whether the radio button is selected. */\n  readonly selected = computed(() => this._pattern.selected());\n\n  /** The RadioButton UIPattern. */\n  readonly _pattern = new RadioButtonPattern<V>({\n    ...this,\n    id: this.id,\n    value: this.value,\n    group: this.group,\n    element: this.element,\n  });\n}\n"],"names":[],"mappings":"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"}