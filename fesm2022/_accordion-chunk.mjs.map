{"version":3,"file":"_accordion-chunk.mjs","sources":["../../../../../k8-fastbuild-ST-fdfa778d11ba/bin/src/aria/private/accordion/accordion.ts"],"sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {KeyboardEventManager, PointerEventManager} from '../behaviors/event-manager';\nimport {ExpansionItem, ListExpansion, ListExpansionInputs} from '../behaviors/expansion/expansion';\nimport {ListFocus, ListFocusInputs, ListFocusItem} from '../behaviors/list-focus/list-focus';\nimport {\n  ListNavigation,\n  ListNavigationInputs,\n  ListNavigationItem,\n} from '../behaviors/list-navigation/list-navigation';\nimport {computed, SignalLike, WritableSignalLike} from '../behaviors/signal-like/signal-like';\n\n/** Inputs of the AccordionGroupPattern. */\nexport interface AccordionGroupInputs extends Omit<\n  ListNavigationInputs<AccordionTriggerPattern> &\n    ListFocusInputs<AccordionTriggerPattern> &\n    Omit<ListExpansionInputs, 'items'>,\n  'focusMode'\n> {\n  /** A function that returns the trigger associated with a given element. */\n  getItem: (e: Element | null | undefined) => AccordionTriggerPattern | undefined;\n}\n\nconst focusMode = () => 'roving' as const;\n\n/** A pattern controls the nested Accordions. */\nexport class AccordionGroupPattern {\n  /** Controls navigation for the group. */\n  readonly navigationBehavior: ListNavigation<AccordionTriggerPattern>;\n\n  /** Controls focus for the group. */\n  readonly focusBehavior: ListFocus<AccordionTriggerPattern>;\n\n  /** Controls expansion for the group. */\n  readonly expansionBehavior: ListExpansion;\n\n  constructor(readonly inputs: AccordionGroupInputs) {\n    this.focusBehavior = new ListFocus({\n      ...inputs,\n      focusMode,\n    });\n    this.navigationBehavior = new ListNavigation({\n      ...inputs,\n      focusMode,\n      focusManager: this.focusBehavior,\n    });\n    this.expansionBehavior = new ListExpansion({\n      ...inputs,\n    });\n  }\n\n  /** The key used to navigate to the previous accordion trigger. */\n  prevKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowUp';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowRight' : 'ArrowLeft';\n  });\n\n  /** The key used to navigate to the next accordion trigger. */\n  nextKey = computed(() => {\n    if (this.inputs.orientation() === 'vertical') {\n      return 'ArrowDown';\n    }\n    return this.inputs.textDirection() === 'rtl' ? 'ArrowLeft' : 'ArrowRight';\n  });\n\n  /** The keydown event manager for the accordion trigger. */\n  keydown = computed(() => {\n    return new KeyboardEventManager()\n      .on(this.prevKey, () => this.navigationBehavior.prev(), {ignoreRepeat: false})\n      .on(this.nextKey, () => this.navigationBehavior.next(), {ignoreRepeat: false})\n      .on('Home', () => this.navigationBehavior.first())\n      .on('End', () => this.navigationBehavior.last())\n      .on(' ', () => this.toggle())\n      .on('Enter', () => this.toggle());\n  });\n\n  /** The pointerdown event manager for the accordion trigger. */\n  pointerdown = computed(() => {\n    return new PointerEventManager().on(e => {\n      const item = this.inputs.getItem(e.target as Element);\n      if (!item) return;\n\n      this.navigationBehavior.goto(item);\n      this.expansionBehavior.toggle(item);\n    });\n  });\n\n  /** Handles keydown events on the trigger, delegating to the group if not disabled. */\n  onKeydown(event: KeyboardEvent): void {\n    this.keydown().handle(event);\n  }\n\n  /** Handles pointerdown events on the trigger, delegating to the group if not disabled. */\n  onPointerdown(event: PointerEvent): void {\n    this.pointerdown().handle(event);\n  }\n\n  /** Handles focus events on the trigger. This ensures the tabbing changes the active index. */\n  onFocus(event: FocusEvent): void {\n    const item = this.inputs.getItem(event.target as Element);\n    if (!item) return;\n    if (!this.focusBehavior.isFocusable(item)) return;\n\n    this.focusBehavior.focus(item);\n  }\n\n  /** Toggles the expansion state of the active accordion item. */\n  toggle() {\n    const activeItem = this.inputs.activeItem();\n    if (activeItem === undefined) return;\n    this.expansionBehavior.toggle(activeItem);\n  }\n}\n\n/** Inputs for the AccordionTriggerPattern. */\nexport interface AccordionTriggerInputs\n  extends Omit<ListNavigationItem & ListFocusItem, 'index'>, Omit<ExpansionItem, 'expandable'> {\n  /** A local unique identifier for the trigger's corresponding panel. */\n  panelId: SignalLike<string>;\n\n  /** The parent accordion group that controls this trigger. */\n  accordionGroup: SignalLike<AccordionGroupPattern>;\n\n  /** The accordion panel controlled by this trigger. */\n  accordionPanel: SignalLike<AccordionPanelPattern | undefined>;\n}\n\n/** A pattern controls the expansion state of an accordion. */\nexport class AccordionTriggerPattern implements ListNavigationItem, ListFocusItem, ExpansionItem {\n  /** A unique identifier for this trigger. */\n  readonly id: SignalLike<string> = () => this.inputs.id();\n\n  /** A reference to the trigger element. */\n  readonly element: SignalLike<HTMLElement> = () => this.inputs.element()!;\n\n  /** Whether this trigger has expandable panel. */\n  readonly expandable: SignalLike<boolean> = () => true;\n\n  /** Whether the corresponding panel is expanded. */\n  readonly expanded: WritableSignalLike<boolean>;\n\n  /** Whether the trigger is active. */\n  readonly active = computed(() => this.inputs.accordionGroup().inputs.activeItem() === this);\n\n  /** Id of the accordion panel controlled by the trigger. */\n  readonly controls = computed(() => this.inputs.accordionPanel()?.inputs.id());\n\n  /** The tabindex of the trigger. */\n  readonly tabIndex = computed(() =>\n    this.inputs.accordionGroup().focusBehavior.isFocusable(this) ? 0 : -1,\n  );\n\n  /** Whether the trigger is disabled. Disabling an accordion group disables all the triggers. */\n  readonly disabled = computed(\n    () => this.inputs.disabled() || this.inputs.accordionGroup().inputs.disabled(),\n  );\n\n  /** Whether the trigger is hard disabled.  */\n  readonly hardDisabled = computed(\n    () => this.disabled() && !this.inputs.accordionGroup().inputs.softDisabled(),\n  );\n\n  /** The index of the trigger within its accordion group. */\n  readonly index = computed(() => this.inputs.accordionGroup().inputs.items().indexOf(this));\n\n  constructor(readonly inputs: AccordionTriggerInputs) {\n    this.expanded = inputs.expanded;\n  }\n\n  /** Opens the accordion panel. */\n  open(): void {\n    this.inputs.accordionGroup().expansionBehavior.open(this);\n  }\n\n  /** Closes the accordion panel. */\n  close(): void {\n    this.inputs.accordionGroup().expansionBehavior.close(this);\n  }\n\n  /** Toggles the accordion panel. */\n  toggle(): void {\n    this.inputs.accordionGroup().expansionBehavior.toggle(this);\n  }\n}\n\n/** Represents the required inputs for the AccordionPanelPattern. */\nexport interface AccordionPanelInputs {\n  /** A global unique identifier for the panel. */\n  id: SignalLike<string>;\n\n  /** A local unique identifier for the panel, matching its trigger's panelId. */\n  panelId: SignalLike<string>;\n\n  /** The parent accordion trigger that controls this panel. */\n  accordionTrigger: SignalLike<AccordionTriggerPattern | undefined>;\n}\n\n/** Represents an accordion panel. */\nexport class AccordionPanelPattern {\n  /** A global unique identifier for the panel. */\n  id: SignalLike<string>;\n\n  /** The parent accordion trigger that controls this panel. */\n  accordionTrigger: SignalLike<AccordionTriggerPattern | undefined>;\n\n  /** Whether the accordion panel is hidden. True if the associated trigger is not expanded. */\n  hidden: SignalLike<boolean>;\n\n  constructor(readonly inputs: AccordionPanelInputs) {\n    this.id = inputs.id;\n    this.accordionTrigger = inputs.accordionTrigger;\n    this.hidden = computed(() => inputs.accordionTrigger()?.expanded() === false);\n  }\n}\n"],"names":["focusMode","AccordionGroupPattern","inputs","navigationBehavior","focusBehavior","expansionBehavior","constructor","ListFocus","ListNavigation","focusManager","ListExpansion","prevKey","computed","orientation","textDirection","nextKey","keydown","KeyboardEventManager","on","prev","ignoreRepeat","next","first","last","toggle","pointerdown","PointerEventManager","e","item","getItem","target","goto","onKeydown","event","handle","onPointerdown","onFocus","isFocusable","focus","activeItem","undefined","AccordionTriggerPattern","id","element","expandable","expanded","active","accordionGroup","controls","accordionPanel","tabIndex","disabled","hardDisabled","softDisabled","index","items","indexOf","open","close","AccordionPanelPattern","accordionTrigger","hidden"],"mappings":"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"}